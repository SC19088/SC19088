<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="SiYu Jiang" />

<meta name="date" content="2020-01-02" />

<title>Introduction to SC19088</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19088</h1>
<h4 class="author">SiYu Jiang</h4>
<h4 class="date">2020-01-02</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>SC19088</strong> is divided into two parts, one of which is two functions I wrote. The fbm function is to generate a Brownian motion. Its hurst index and the number of generations can be specified at will. The default values are 0.7 and 100. The other function is. The remaining part is my homework for statistical calculations this semester.</p>
<p>The R package ‘microbenchmark’ can be used to benchmark the above R and C++ functions.</p>
</div>
<div id="generate-100-numbers-with-brownian-motion-hurst" class="section level2">
<h2>Generate 100 numbers with Brownian motion Hurst</h2>
<p>The source R code for <em>fbm</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="cf">function</span>(<span class="dt">hurst=</span><span class="fl">0.7</span>, <span class="dt">n=</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb1-2" title="2">  delta &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb1-3" title="3">  r &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">  r[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb1-6" title="6">    r[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>hurst) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>k<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>hurst) <span class="op">+</span><span class="st"> </span>(k<span class="dv">-1</span>)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>hurst))</a>
<a class="sourceLine" id="cb1-7" title="7">  r &lt;-<span class="st"> </span><span class="kw">c</span>(r, r[<span class="kw">seq</span>(<span class="kw">length</span>(r)<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>)])</a>
<a class="sourceLine" id="cb1-8" title="8">  lambda &lt;-<span class="st"> </span><span class="kw">Re</span>((<span class="kw">fft</span>(r)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>n))</a>
<a class="sourceLine" id="cb1-9" title="9">  W &lt;-<span class="st"> </span><span class="kw">fft</span>(<span class="kw">sqrt</span>(lambda) <span class="op">*</span><span class="st"> </span>(<span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n)<span class="op">*</span>1i))</a>
<a class="sourceLine" id="cb1-10" title="10">  W &lt;-<span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span>hurst) <span class="op">*</span><span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">Re</span>(W[<span class="dv">1</span><span class="op">:</span>(n<span class="op">+</span><span class="dv">1</span>)]))</a>
<a class="sourceLine" id="cb1-11" title="11">  X &lt;-<span class="st"> </span><span class="kw">ts</span>(W, <span class="dt">start=</span><span class="dv">0</span>, <span class="dt">deltat=</span>delta)</a>
<a class="sourceLine" id="cb1-12" title="12">  <span class="kw">return</span>(X)</a>
<a class="sourceLine" id="cb1-13" title="13">}</a></code></pre></div>
<p>This is the implementation of our function example.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">fbm &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">hurst=</span><span class="fl">0.7</span>, <span class="dt">n=</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb2-2" title="2">  delta &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>n</a>
<a class="sourceLine" id="cb2-3" title="3">  r &lt;-<span class="st"> </span><span class="kw">numeric</span>(n<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">  r[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb2-6" title="6">    r[k<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>hurst) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>k<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>hurst) <span class="op">+</span><span class="st"> </span>(k<span class="dv">-1</span>)<span class="op">^</span>(<span class="dv">2</span><span class="op">*</span>hurst))</a>
<a class="sourceLine" id="cb2-7" title="7">  r &lt;-<span class="st"> </span><span class="kw">c</span>(r, r[<span class="kw">seq</span>(<span class="kw">length</span>(r)<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>)])</a>
<a class="sourceLine" id="cb2-8" title="8">  lambda &lt;-<span class="st"> </span><span class="kw">Re</span>((<span class="kw">fft</span>(r)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span><span class="op">*</span>n))</a>
<a class="sourceLine" id="cb2-9" title="9">  W &lt;-<span class="st"> </span><span class="kw">fft</span>(<span class="kw">sqrt</span>(lambda) <span class="op">*</span><span class="st"> </span>(<span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n) <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n)<span class="op">*</span>1i))</a>
<a class="sourceLine" id="cb2-10" title="10">  W &lt;-<span class="st"> </span>n<span class="op">^</span>(<span class="op">-</span>hurst) <span class="op">*</span><span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">Re</span>(W[<span class="dv">1</span><span class="op">:</span>(n<span class="op">+</span><span class="dv">1</span>)]))</a>
<a class="sourceLine" id="cb2-11" title="11">  X &lt;-<span class="st"> </span><span class="kw">ts</span>(W, <span class="dt">start=</span><span class="dv">0</span>, <span class="dt">deltat=</span>delta)</a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="kw">return</span>(X)</a>
<a class="sourceLine" id="cb2-13" title="13">}</a>
<a class="sourceLine" id="cb2-14" title="14">d &lt;-<span class="st"> </span><span class="kw">fbm</span>(<span class="dt">hurst=</span><span class="fl">0.5</span>, <span class="dt">n=</span><span class="dv">500</span>) </a>
<a class="sourceLine" id="cb2-15" title="15"><span class="kw">plot</span>(d)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAASFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6kNtmAABmtrZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb////tmb/25D//7b//9v///9cJ2NrAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHsklEQVR4nO2dgXasJhRFb/KSpk2a9E2Txv//046Kjqh4uHJRmJy9Vl/HES5mBxEYhkhDNpGzL6B0KAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQwFiQVMNZgmzD5YOCABQE+FmCulLjm5Uxi2nCU8JpSqWgzVKFgrZL1Ty5XRbjhKeEiy+VgrYKlUbV9+vymCc8JVxkoRSEyuwVKTMZJzwlXGyZ0j/HdJmME54SLrZMCkJlUlC4xFvbE2yoV979kYJCDfXauz9J0PT1snz58YKmr50h8c9T0OT1XJDI+jA2i6D//ny5/vt5LfPxt0E4G2R56LVKQ7WaWcon6PLr3/bVa3o4G1YFDW+K62Ive9rZBDk1nabEcDYsBMm5gr6eO0GfgZvsaEGL5kVGFzJUpZ9cg5bP9X5Y3/3n3WvzjnYmQW3pT83QXCeGMyAkyLXMk8b6EEFN5+jh/fogC/gpSpCcIejgcLC4ZRdHxhlYCgoNvmQ45fWHjhV0KeEptjnBcbKg5dUoF02YlLp59UUJyhUOFLb5+/B+XUPP6PZGdCH66zow3GYZqMJ6pw8S9P3W30inDlZjBS0uJr+gy9D/CXaEDhA0Ni3w4/g1QSLr56KDbPH9NmrRDTVMtU0E6bOO912mocY4yaEbrN5uCkVpIVIESV5ByTXIpBuQIGjyCXWuNshVIWUblEPQrli5BbnxvEig/gTCjT9LuiBJFzQGii7RElk7Gj9skEWHVh/fTcLvc12qoHFqzx8g7YnvHO8c1Yi+ATtMUNJv/hbRjRl2hilMkPiCpAhBw6voLHvKiQs3ud9l2g6lXMDwyen9CRp/thRBchO088JLFdQfujdX26nI6ONzMfXCixA0axB9QTJLFBX91qFKuchJ8YYJ9eHGPo9frQZTjZuj2SUo7So1EQ4QJPME06qkFJR8gdPrsE2oD7cqaHhjfOxT0KqgsWOkE5R8ffpQZwmaKtoTPBWloGGUvjnfrC13Q5DUJqiln+P5fHi3Klea5act7oR/k+0Jnope0PfbU/f/0FyhutxhAB8QNM5/1iJomHAOzTary90Q5I2oahE0TDh/GNWgwMhics6Zin92n94GtVXoYtUGDQOwrTW4dQnqH2VJ9Wf2ozdYUKMQZLoy4ux+0G1ICgVFXYLKZAzlCNosQSco6crWSjZNqAoXO+HnGvK4hHckSDefFSVI1R+IKdQ84XaUEXeoyxyXpmZBSeEiBdku76tJUEwmCkJJKAgkoSCUxHiFcbWCAgEoaHi53sVUjWm1ZRolzBhuKmhdhPFVaiKWIMibJKGgzVzrHeYMXwGpT9DW6J+Cmk1BOb5DVJ2grfkjCvIWxSx1UJC/1GPhI4OfKgXJKEj8cwbXtSzRPGHecCKhdZ7pq/PXCzRPmDccBaF8/XyGjAfemQxUKmgZJpOfOgWthcmjJ5OgnDtQzQSNr+sTlGkHqtkwvl5B+fYPWhOUqwXKKCjfDlSyclChoIw1aOUgl55sgtq+3CE7UNUpqDluB6q+S12hoKPCuTGHUbRQAaYJDw63Ou9hSG5B2Xegql1Q9nAUFBHojgTNVphZRGxyPuSzCTpuB6o6BR24A1WVgnbvH7SDKgXt3oFqB+YLghbxrRM2R9egCgXt3oFqB/kmOlx884Qd+3ag2kOlgo4Ll9lPVkGTpsgiXCAQBZ0LBQEoCEBBgNOeYtVwkqC4oOB82unU7GnJbYJSUNp5CqKgtPMUREFp5ymIgtLO37+ge4KCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBLAV9ity2yvUO9Nkb9b7EXvaLiAS+0qbEUFC7mfm4obl3oM/eHus23vWyX7ovlJgYshPUf+D68bQ80GdvuqVIGkGz0p+UpYexE9R/1c59R8E70GdvX/36WyPIy16ooD/a+u1Wd3oH+uzdoaoN8rMXeYv1DYBrBrwDffbujlEJmhWof0SEKFRQu4o2QdDHtSZ9PYcXoSgo8xbrDvbfYvoWMEyZjfTFrVGJb0W87Pr6G6bYx7yyBnnZe1tpfyFkoNyOorIn7WUvsg3qboz2CvteyEX9HPGyN+qhhpf943p/mvjhYBVBQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAhQnaNhHTh7/Cf1tikMpTlBLvxqqDCgIULCgdmfUr+e/rrfcy9dzv9rsYraqJZriBT28X7U8/u5W17Wre43WRUVTvKCXZvjn1f3xJZOVddEUL+i1Gf/pV9i5P55zFFUJUq99NaAqQUaL51XUJCj4V81yUpOg7inWfBxbj6oS1PWDjn2IlSmoJCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/f4hg2F2MELMAAAAASUVORK5CYII=" /><!-- --></p>
<p>The above picture show an Brownian motion Hurst which hurst is 0.5.</p>
</div>
<div id="compare-different-orders-k-in-b-spline-regression-functions-with-any-m-equidistant-inner-knots" class="section level2">
<h2>Compare different orders k in B-spline regression functions with any m equidistant inner knots</h2>
<p>The source R code for <em>Bs</em> is as follows:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">Bs &lt;-<span class="st"> </span><span class="cf">function</span>(n,m){</a>
<a class="sourceLine" id="cb3-2" title="2">  f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sin</span>(<span class="dv">12</span><span class="op">*</span>(x<span class="fl">+0.2</span>))<span class="op">/</span>(x<span class="fl">+0.2</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">  knots_eq &lt;-<span class="st"> </span><span class="cf">function</span>(x, k, m)</a>
<a class="sourceLine" id="cb3-4" title="4">  {</a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="kw">c</span>(<span class="kw">min</span>(x) <span class="op">-</span><span class="st"> </span>((k<span class="dv">-1</span>)<span class="op">:</span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">max</span>(x)<span class="op">-</span><span class="kw">min</span>(x))<span class="op">/</span>(m<span class="op">+</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb3-6" title="6">      <span class="kw">seq</span>(<span class="dt">from=</span><span class="kw">min</span>(x), <span class="dt">to=</span><span class="kw">max</span>(x), <span class="dt">length.out=</span>m<span class="op">+</span><span class="dv">2</span>)[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,m<span class="op">+</span><span class="dv">2</span>)],</a>
<a class="sourceLine" id="cb3-7" title="7">      <span class="kw">max</span>(x) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(k<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span>(<span class="kw">max</span>(x)<span class="op">-</span><span class="kw">min</span>(x))<span class="op">/</span>(m<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb3-8" title="8">  }</a>
<a class="sourceLine" id="cb3-9" title="9">  x=<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-10" title="10">  e=<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-11" title="11">  y=<span class="kw">f</span>(x)<span class="op">+</span>e</a>
<a class="sourceLine" id="cb3-12" title="12">  ks &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb3-13" title="13">  cols_k &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="kw">length</span>(ks))</a>
<a class="sourceLine" id="cb3-14" title="14">  <span class="kw">par</span>(<span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.65</span>,<span class="fl">0.6</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb3-15" title="15">  <span class="kw">plot</span>(x, y, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb3-16" title="16">  <span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">knots_eq</span>(x, <span class="dv">1</span>, m), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">2</span>,m),<span class="dv">1</span>), <span class="dt">col=</span><span class="st">&quot;grey60&quot;</span>)</a>
<a class="sourceLine" id="cb3-17" title="17">  <span class="cf">for</span> (kk <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ks))</a>
<a class="sourceLine" id="cb3-18" title="18">  {</a>
<a class="sourceLine" id="cb3-19" title="19">    k &lt;-<span class="st"> </span>ks[kk]</a>
<a class="sourceLine" id="cb3-20" title="20">    est &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="st">                </span><span class="kw">splineDesign</span>(<span class="dt">x=</span>x, <span class="dt">knots=</span><span class="kw">knots_eq</span>(x, k, m), <span class="dt">ord=</span>k))</a>
<a class="sourceLine" id="cb3-22" title="22">    <span class="kw">plot</span>(<span class="cf">function</span>(x) <span class="kw">splineDesign</span>(<span class="dt">x=</span>x, <span class="dt">knots=</span><span class="kw">knots_eq</span>(x, k, m), <span class="dt">ord=</span>k) <span class="op">%*%</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="st">           </span>est<span class="op">$</span>coef,</a>
<a class="sourceLine" id="cb3-24" title="24">         <span class="dt">from=</span><span class="kw">min</span>(x), <span class="dt">to=</span><span class="kw">max</span>(x), <span class="dt">n=</span><span class="dv">1001</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span>cols_k[kk], <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-25" title="25">  }</a>
<a class="sourceLine" id="cb3-26" title="26">  <span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">inset=</span><span class="fl">0.02</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;k = &quot;</span>,ks,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;knots&quot;</span>),</a>
<a class="sourceLine" id="cb3-27" title="27">         <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(ks)),<span class="dv">2</span>), <span class="dt">col=</span><span class="kw">c</span>(cols_k, <span class="st">&quot;grey60&quot;</span>), <span class="dt">bg=</span><span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb3-28" title="28">}</a></code></pre></div>
<p>The R code for using <em>Bs</em> is as follows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(<span class="st">&quot;splines&quot;</span>)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">library</span>(<span class="st">&quot;nlme&quot;</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">library</span>(<span class="st">&quot;MASS&quot;</span>)</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">library</span>(<span class="st">&quot;mgcv&quot;</span>)</a></code></pre></div>
<pre><code>## This is mgcv 1.8-31. For overview type &#39;help(&quot;mgcv-package&quot;)&#39;.</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">Bs &lt;-<span class="st"> </span><span class="cf">function</span>(n,m){</a>
<a class="sourceLine" id="cb6-2" title="2">  f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sin</span>(<span class="dv">12</span><span class="op">*</span>(x<span class="fl">+0.2</span>))<span class="op">/</span>(x<span class="fl">+0.2</span>)</a>
<a class="sourceLine" id="cb6-3" title="3">  knots_eq &lt;-<span class="st"> </span><span class="cf">function</span>(x, k, m)</a>
<a class="sourceLine" id="cb6-4" title="4">  {</a>
<a class="sourceLine" id="cb6-5" title="5">    <span class="kw">c</span>(<span class="kw">min</span>(x) <span class="op">-</span><span class="st"> </span>((k<span class="dv">-1</span>)<span class="op">:</span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">max</span>(x)<span class="op">-</span><span class="kw">min</span>(x))<span class="op">/</span>(m<span class="op">+</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb6-6" title="6">      <span class="kw">seq</span>(<span class="dt">from=</span><span class="kw">min</span>(x), <span class="dt">to=</span><span class="kw">max</span>(x), <span class="dt">length.out=</span>m<span class="op">+</span><span class="dv">2</span>)[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span>,m<span class="op">+</span><span class="dv">2</span>)],</a>
<a class="sourceLine" id="cb6-7" title="7">      <span class="kw">max</span>(x) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span><span class="op">:</span>(k<span class="dv">-1</span>)) <span class="op">*</span><span class="st"> </span>(<span class="kw">max</span>(x)<span class="op">-</span><span class="kw">min</span>(x))<span class="op">/</span>(m<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb6-8" title="8">  }</a>
<a class="sourceLine" id="cb6-9" title="9">  x=<span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-10" title="10">  e=<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-11" title="11">  y=<span class="kw">f</span>(x)<span class="op">+</span>e</a>
<a class="sourceLine" id="cb6-12" title="12">  ks &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">6</span></a>
<a class="sourceLine" id="cb6-13" title="13">  cols_k &lt;-<span class="st"> </span><span class="kw">rainbow</span>(<span class="kw">length</span>(ks))</a>
<a class="sourceLine" id="cb6-14" title="14">  <span class="kw">par</span>(<span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.65</span>,<span class="fl">0.6</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>), <span class="dt">mgp=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb6-15" title="15">  <span class="kw">plot</span>(x, y, <span class="dt">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb6-16" title="16">  <span class="kw">abline</span>(<span class="dt">v=</span><span class="kw">knots_eq</span>(x, <span class="dv">1</span>, m), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">rep</span>(<span class="dv">2</span>,m),<span class="dv">1</span>), <span class="dt">col=</span><span class="st">&quot;grey60&quot;</span>)</a>
<a class="sourceLine" id="cb6-17" title="17">  <span class="cf">for</span> (kk <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(ks))</a>
<a class="sourceLine" id="cb6-18" title="18">  {</a>
<a class="sourceLine" id="cb6-19" title="19">    k &lt;-<span class="st"> </span>ks[kk]</a>
<a class="sourceLine" id="cb6-20" title="20">    est &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">-1</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="st">                </span><span class="kw">splineDesign</span>(<span class="dt">x=</span>x, <span class="dt">knots=</span><span class="kw">knots_eq</span>(x, k, m), <span class="dt">ord=</span>k))</a>
<a class="sourceLine" id="cb6-22" title="22">    <span class="kw">plot</span>(<span class="cf">function</span>(x) <span class="kw">splineDesign</span>(<span class="dt">x=</span>x, <span class="dt">knots=</span><span class="kw">knots_eq</span>(x, k, m), <span class="dt">ord=</span>k) <span class="op">%*%</span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="st">           </span>est<span class="op">$</span>coef,</a>
<a class="sourceLine" id="cb6-24" title="24">         <span class="dt">from=</span><span class="kw">min</span>(x), <span class="dt">to=</span><span class="kw">max</span>(x), <span class="dt">n=</span><span class="dv">1001</span>, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">col=</span>cols_k[kk], <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-25" title="25">  }</a>
<a class="sourceLine" id="cb6-26" title="26">  <span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="dt">inset=</span><span class="fl">0.02</span>, <span class="dt">legend=</span><span class="kw">c</span>(<span class="kw">paste</span>(<span class="st">&quot;k = &quot;</span>,ks,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>), <span class="st">&quot;knots&quot;</span>),</a>
<a class="sourceLine" id="cb6-27" title="27">         <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty=</span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(ks)),<span class="dv">2</span>), <span class="dt">col=</span><span class="kw">c</span>(cols_k, <span class="st">&quot;grey60&quot;</span>), <span class="dt">bg=</span><span class="st">&quot;white&quot;</span>)</a>
<a class="sourceLine" id="cb6-28" title="28">}</a>
<a class="sourceLine" id="cb6-29" title="29"><span class="kw">Bs</span>(<span class="dv">100</span>,<span class="dv">6</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAclBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrYA/wAA//86AAA6ADo6AGY6Ojo6kNtmAABmADpmZmZmtrZmtv+QOgCQZgCQtpCQ2/+ZmZm2ZgC2/7a2///bkDrb/9vb////AAD/AP//tmb/25D//wD//7b//9v////Fbc+jAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPfklEQVR4nO2d62LjKBKFSWvSTvdMvJfsxt71dltRwvu/4goQErcqEBJlyeb86IkNBumbooASAsarULFbX8DWVQFFVAFFVAFFVAFFVAFFVAFFVAFFFAH08eOf4C+VDgd2RzrpP2KAPo/Tj779F0N7OOCI96XT8N8oIN6yV/EfzILUfx4VUG9Dz79CgCbLGr64K0IzAHF+fnpPsCAc0AlJi6QWSkz7aRIgfmGvcUDsgQH19vNHDJDsxjKvZv+A+NcbwwEx1c/nXc0dAMJUAUWUBGhvWh1QzAftTesDivRie1MBQNcrRujhfVAFBGsEdF0HEHN8/b0AalYCZAcZYj/dESC+DiA3DPMogNJL8wDdRBVQRGUANfkXZBS3BT5FBop9N7bKXOxOezHGTj0gsJQ6DqqAQBmA4OlqBcS7DuvGVgO02iBpY4DWEtUgoEQ3363Uz6N1UQ2TKqCICgG6RivMSPVmsiagHfkg6YTyrmbGbboGVAHdTy/GTySAVksMp2r8pQCBXnongMYGTA5oH5q6gAooqAoootKAEC9dfZAoc/+AyvZiNwDETth1b20cRA9ILtfNLPZGgCAvXQTQsJ45r9iNASqiglP7CiiiMoDWejSWXnWx2FAhQLCXrr3YbQDtK9xRAYVlAwKcUAVUDNACN7M9QAW6sRst9igJaNUbutVyoXKAruve0L0BOgyAvNJy3cGi6RaND7r01yff9Lng76wWACTKWTJhJwF0eXrnn8fvPA1QtyYgVdDGe7Gvt1f57/OvVEBN0GfkBfdkUdseB30e1Yt05+dfDiA2yixTAVrlWvcBSFlQr/P3FAtacyB0qw5MaoYPGrB8HiMbC6wOCBkjMhKZN4f2YqqRfb2lAYKfz88WaD8kZpUKKK0gPgA6AIul152s7hxQqKg5gBzDuStATI0U/UwzALmu5+4ANcsAeZ3XiXtGtWNArAgg16j2C4hLQAuuKjj88b7aMaAVBkIun8OgOwF0WD4QsvgcDHlVFhUtoMxxkMBy4o3ShOhhAbkjBIGkayZpQo8KyPE+slUJLl3XfxoQLbzYGdoeIKez0nhOnZD4ZiS0c0ChbiwLEJfWc2JMIXp50Ua0Z0AL+nkbUG9Ako/87qXXdVL2xX4eX+HEjz/tiOD4D7f/misPUHY/bxLSfDqPTilAn8dvJIAWDIQMQCMfPtKR7ez376YpA6h1txotCCh3LmYB6vnwrtN4ZLpyRX2CU8FvTFZOCejCApRa9trSAfILSx4HWXxMOkKSUOcCQvn4gHSI9OOHrO7pXSfSAAIiQokjabOB8QGPdYuK0JIm1oIbHu4B0CBpQC/KeBwbkIgWAPor1L6U6AAFIkKzAEk+um25gASiBYCe/v3zHUik80ELI0ISkOi25AcfEF8C6FU8A5V/38gHcf6yNODR81HduvwUAJR/sQIQuG8vFaDFEaHDQY161KfVAfEz8IDvpoBm+CDJ50XzKQBILVbxtRtAik8RQHNUElDnZUoHJPnwkU8F5KZeRTigu3NAfsAjAmiaGQg+v+WsNDxZWHixM1QS0MxuzJw69XwEIHA2tfBiZ6gYoPn9vMHAbWB4lUVVFFDkBh1NgASfJsrnHgGhPsgEJKNAsZ8WCJh9vfXTDitxi4CCBkQC6Outn5NdmDmC3CYg34BoAKkJmrVOtSggz0snAQp7oNUBBUOuUu2TEQopCCjQjSUCCnnoOKAOk5UTDbk609iygGZ1YxKQWHt1HR4zy2KRJdJ2CsrHAwSHXPVRYWYlRQDN7ucFICYXp00G5K2iClU5W3jI1fLRGwPEHAMKrDMLVDlbWMi1ddAVBuSUF/NBgwGFAK3tpIGQq+e6SwOyC4wAcg2oJKBwyPXiuabigKwSUwAJA5pKHfgwtno3Hwq5fvzwXFNJQL4JpQEy+xzNJ/RC3foh1wvz+vyCgJhvQlFAqoV5ZbPgK5k3nKx+HpmDV87iGHjKKgYo9T4UINuAhpLCndlNZ/MXe1Y7One3F/R+aTxg14ASb6TvxcIGtElA3GI0vnHYfzt0j8GCuLVEIweQWM4RKDxYyq0BKUSyTel3Vrn/2GjU8AUKKDYOChsQX7sXmyMYUMvEm/LyTecFFmR76Qgg2cKA1I0BEqdfKxLKYsYB1Cwf1Lj9fBjQwFCF6qETA7YFqJ+sOFMVfV44YD/BXox5s7EgIN0KFSDoQmlCrsKr2LdecBwUmK6GAGkXxtAWRgRIBBOteBkxoOAPDUBwC8OqnC0QkEz4eqOJSfONAwJDrlsDNPogtIVhVeraMFk58ZDrhbSJ2YTQXgw3oKgPQvl4gMCQa0v2XExcc5MEaNBCQDOEhlyHoZ9VSSlAXAHyh9khdXgLWxcQssqV7LGPkHRCxmwDAyRc0LwTSEuEXNVXRvMrD8icquGA0D6MJOSqvmxpnosJuYAQdemdvC5t/ZCrtCtj4skLAxqnqwmAIi3MLFUXt37ItSfEmN2/FQeUGBJKN6DJIm8fD5pdEHcBNXbUFfZBAhB2ELv1KtC+AVmvaQlA+ELDQdeHAWS/x3ZIBBRvYQ6gZRc7Q2V7MXc2BhKKtjD7dcT7AmQQAgG9VEBSEKAu6oKmeu4MkD1dBQAx1cJgF25lHnvFEiFXzsdJCJ8qKQeI44C0KcwBNM19ywBq2XYAaWMYWhgKiChoL55OEAJyH2zYgEZ3ogyIGBAQcr08/4sOkH54OH6BAkKGkTwF0AsmKycScv34+U7ng1gioG4VQCgfDxAQchUzeXJAVwgQnwzoelhuQemCQ67iwTotINYggPjoo8UgCAeEVDlbYMj1Q3xL2M1HAUl1GCAsUrJ+yHVYgsfIQq7M6cbCgF5kCwu/lorFktYPuUrRDhTtyUYYkHRBwURjXkGyylVqa4B0C6MGBG0sQA2Im90YBOhAC2iOygNqYoBeVAuL+KCHBdQpF9RjwHux+waE7MAhz84WgBjdOGh2JUUBqWdj6m8A0OGhAfHrtJQztNHW0MIeGFAzvbIRBsRTAN2vD4oDOlRAIKCua2Qnz6BebBRNRFGtdiZbo6jUTF46AGiYZ4QSLdEA+vAm+QSAjLF0YLvIYRg9JQKzUxpArTdBowDUIICa0YCGxKS1IHaVuhpMVk44Jn3x5md0gEJuxgdkzL6SqxxqmQcoHJM+/8UyV7nOOiXTUTOuVHQAdcoFmaPIfEAzBMakP49iJn/OWGE275RMV+NCPA+QNKAkQHTLgHPWKM48JdOVPrkXADR8wn0Q4TLgjFWu8CmZ3i9DgPQ6MweQ2DS7B6Q/0vZi2DLgn7PXSc89JdORAcisQBqQBwjQxpcBzzwl05EByJRqYSkL9MLlFohJn4WbzXHS4CmZbNTwRXCdpnZCPp9kQAGViEnTLgMe1WgvbdJUBpRd4RYnq/Ya9EBBHAbEPUIV0CRJgqlD4zUg1YeZudCXpXYR7sgGxAdTOXEL0LUC0hpQnLRX7//2DOihAQ3eRiaOHuj+AEUL4imAlPwW9tCAuDHnUvINKLvK2UIWcYqZB9U2gZauTo8eaGHZVc4WElHsZ2j2CJIKUOOYkOSzOUDKyRJtdmtLAjpMiSEDWuiDrpisnGDI1Y/ZkwHi1yk6zyWftQGhfHxAwZBr++0/R8qNBXSS6NeVCQ2EhnONnHxkvRgYcr2IWAXh3h1DihwZNvIRs1bIgCgBASFXtW0H4WvhMkFJhOf5aQIUOD2KEBAQclXumXBjAZkwTC7MJtWs0IeVCLkq28kIuSYoCqibiHRBA8qucrbAkKuKvRM3MfOFg+GbdQyoRMj1Qrvzgk5Ss9MXfdpPAxgQZS8GhVzb3CerUcXGQWohhyAk9kO+LaA5ogYkJfhUQJ5GQgCfCkiCEcfGA11YBST2074yyICyqywqWkDMnzumrnVBqiwqOkBMbrUU4JNN6A4BneQrvEYl1mNr2nFQUK03vCYE1BM6iX8668tNATI2FrcqofFBEhAP8amAlHpA4h/DLycsDOFw4jJAF/b6efzHUS3mUDMMMbN//iXn9yMoakBdZ276tiqg0yDo8yQdcpX7iosgWSs/fJcWJKf5U8CRFpDq611CS6scKnaAuJ8N6ZCrtKQeiJq/t0/vAhDVYdheuvDPHqAlw6DlIVfpcvp/VGyo/1d88Xm0CFEBklFXKRvQEi0OudqA+j/kF/IQGmofNMSlZR8P8iF10mf5DDVgQVLncdXrDQCBzYoUkICiAVk+aMhB7KQtQJBou/nzt/9qQEYv9qp2k26pLYhrQFgR5CHXEdAYaT3346CWmevKKXuxzQCaI1ILYtEDwLOqLCpaQOveUgWUWGVRkfqg0CFhhh7aB0lAOILHBsQeAxC88VfSQPF+m5g+fk0o432x+wekT+5bakE5VwhrS4CGF6azAS2LjEWqLKp0HyQiAPmAFkXGIlUW1QwnfWGvCwDFE+f7IBKZNxf5n/Lx4w8PkF1Qxl2mphZKTPtpajf/9Qad63YTC1ojcW1Aue+LpSTeOyA91MHaM5q44KfFK10BUFIBhXMSVF4BRXJWQJGci8deFVCpmtfIWQHdvvIKKJKzAorkrIAiOSugSE6SEMueVQFFVAFFVAFFVAFFVAFFVAFFVAFFVAFFVAFFVAFFVAFFVAFFlAuoNddet/YG33BO+doI+BzALcY+Wg/K6O3zB+YczzEI6+PPcSGU8bNMQGLl/rh63/qA5fx6E++zQbfjFuOc4g1V7u3zB+XUL9IBMt6KMn+WB0g9Djp/9z+gOdVaEWAPeLcY9xRvrPKUItVOZcBlSqPRhVg/ywNk3Sl624FEwNjcnO4p3kDlyGEHdk4cUMtexzcPrZ9lAvpp7I1mfUBzKgHnnTo5vVO8wxkD+/xBRUaamFX19DEPkDKCwRSsD2hO9Q1wO3ZO/xTvcMbAPn9g5WhfYgCyfkYOqMV89JTTP8U7nDGwzx9UpLDcjx/ws/Q1AeU3Mch+QmWmNLHAPn9QkZir5OZFrtDEsp108AirQM7AKd7hjIF9/qCcmKFPRbk/I+3mx/1U4zmFAAuyMgb2+QNyBg5hsTUmrdDNZw4UMQ8QKAYaSdvDP2+fPyhnsg9aYaAo24AoQfUfF6x7MHIODQfKa5XJkamGlbHFZi9WzjOWcwDk3VCdrEZUAUVUAUVUAUVUAUVUAUVUAUVUAUVUAUVUAUW0B0BiXo0cX1RWewAk5qIXaF5WWnsAJALPf0NipUW1C0D9PBx8NFha+wCEPYworF0A+nr7OxwILKxdALo8/y/+Zl8h7QFQYMNVOu0B0FmGnW/kpvcA6KaqgCKqgCKqgCKqgCKqgCKqgCKqgCL6P9G38JHj43qSAAAAAElFTkSuQmCC" /><!-- --></p>
<p>The results show the picture compares different knots in m=6 to fit function f(x)=sin(12*(x+0.2))/(x+0.2).</p>
<hr />
</div>
<div id="homework-in-20190925" class="section level2">
<h2>Homework in 20190925</h2>
</div>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, figures,tables).</p>
<hr />
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>The mtcars is a data set about cars that R software comes with.</p>
<div id="summary-of-mtcars" class="section level3">
<h3>summary of mtcars</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">summary</span>(mtcars)</a></code></pre></div>
<pre><code>##       mpg             cyl             disp             hp       
##  Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  
##  1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  
##  Median :19.20   Median :6.000   Median :196.3   Median :123.0  
##  Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  
##  3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  
##  Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  
##       drat             wt             qsec             vs        
##  Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  
##  1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  
##  Median :3.695   Median :3.325   Median :17.71   Median :0.0000  
##  Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  
##  3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  
##  Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  
##        am              gear            carb      
##  Min.   :0.0000   Min.   :3.000   Min.   :1.000  
##  1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  
##  Median :0.0000   Median :4.000   Median :2.000  
##  Mean   :0.4062   Mean   :3.688   Mean   :2.812  
##  3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  
##  Max.   :1.0000   Max.   :5.000   Max.   :8.000</code></pre>
</div>
<div id="example-of-figures" class="section level3">
<h3>example of figures</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">plot</span>(mtcars<span class="op">$</span>mpg,mtcars<span class="op">$</span>disp)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
</div>
<div id="homework-in-20191006" class="section level2">
<h2>Homework in 20191006</h2>
</div>
<div id="questions" class="section level2">
<h2>Questions</h2>
<ul>
<li>Exercises 3.4, 3.11, and 3.18 (pages 94-96, Statistical Computating with R).</li>
</ul>
</div>
<div id="answers" class="section level2">
<h2>Answers</h2>
<div id="section" class="section level3">
<h3>3.4</h3>
<ul>
<li>In this question,we can easily calculate the corresponding distribution function: <span class="math display">\[F(x)=1-e^{-\frac{x^2}{2\sigma^2}}\]</span> Then we can get inverse function <span class="math inline">\(F^{-1}(x)\)</span>: <span class="math display">\[F^{-1}(x)=\sqrt{-2\sigma^2ln(1-x)}\]</span> Then we can use the inverse transform method in Lec 1 Page 7. I choose the <span class="math inline">\(\sigma\)</span> is 0.5.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co">### Nf is the inverse function. </span></a>
<a class="sourceLine" id="cb10-2" title="2">Nf=<span class="cf">function</span> (Sigma,x)</a>
<a class="sourceLine" id="cb10-3" title="3">{</a>
<a class="sourceLine" id="cb10-4" title="4">  FN=((<span class="op">-</span><span class="dv">2</span><span class="op">*</span>Sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>x)))<span class="op">^</span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb10-5" title="5">  FN</a>
<a class="sourceLine" id="cb10-6" title="6">}</a>
<a class="sourceLine" id="cb10-7" title="7"></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">### pdf is the  Rayleigh density function.  </span></a>
<a class="sourceLine" id="cb10-9" title="9">pdf=<span class="cf">function</span> (Sigma,x)</a>
<a class="sourceLine" id="cb10-10" title="10">{</a>
<a class="sourceLine" id="cb10-11" title="11">  f=x<span class="op">/</span>Sigma<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Sigma<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb10-12" title="12">  f</a>
<a class="sourceLine" id="cb10-13" title="13">}</a>
<a class="sourceLine" id="cb10-14" title="14">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb10-15" title="15">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb10-16" title="16">Sigma=<span class="fl">0.5</span> <span class="co">#Here we can change Sigma </span></a>
<a class="sourceLine" id="cb10-17" title="17">x &lt;-<span class="st"> </span><span class="kw">Nf</span>(Sigma,u)</a>
<a class="sourceLine" id="cb10-18" title="18"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-19" title="19">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">.005</span>)</a>
<a class="sourceLine" id="cb10-20" title="20"><span class="kw">lines</span>(y, <span class="kw">pdf</span>(Sigma,y))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level3">
<h3>3.11</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">n=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb11-2" title="2">x1=<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-3" title="3">x2=<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-4" title="4">choose=<span class="cf">function</span>(p)</a>
<a class="sourceLine" id="cb11-5" title="5">{</a>
<a class="sourceLine" id="cb11-6" title="6">  p.new=<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>p,p))</a>
<a class="sourceLine" id="cb11-7" title="7">  <span class="co">### The probility that p.new is 1 is p,the probility that p.new is 0 is 1-p.</span></a>
<a class="sourceLine" id="cb11-8" title="8">  X=p.new<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p.new)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb11-9" title="9">  X</a>
<a class="sourceLine" id="cb11-10" title="10">}</a>
<a class="sourceLine" id="cb11-11" title="11"></a>
<a class="sourceLine" id="cb11-12" title="12">f=<span class="cf">function</span>(x,mu)</a>
<a class="sourceLine" id="cb11-13" title="13">{</a>
<a class="sourceLine" id="cb11-14" title="14">  f=<span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">-</span>mu)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>(<span class="dv">2</span><span class="op">*</span>pi)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb11-15" title="15">  f</a>
<a class="sourceLine" id="cb11-16" title="16">}</a>
<a class="sourceLine" id="cb11-17" title="17"></a>
<a class="sourceLine" id="cb11-18" title="18"></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="kw">hist</span>(<span class="kw">choose</span>(<span class="fl">0.75</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">hist</span>(<span class="kw">choose</span>(<span class="fl">0.5</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">hist</span>(<span class="kw">choose</span>(<span class="fl">0.85</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">hist</span>(<span class="kw">choose</span>(<span class="fl">0.95</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>The empirical distribution of the mixture is bimodal.</li>
</ul>
<hr />
</div>
</div>
<div id="homework-in-20191011" class="section level2">
<h2>Homework in 20191011</h2>
</div>
<div id="question-1" class="section level2">
<h2>Question</h2>
<ol style="list-style-type: decimal">
<li><p>Compute a Monte Carlo estimate of <span class="math display">\[ \int_{0}^{\pi /3}sint\ dt\]</span> and compare your estimate with the exact value of the integral.</p></li>
<li><p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_{0}^{1}\frac{e^{-x}}{1+x^{2}}\ dx\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p></li>
<li><p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p></li>
</ol>
<hr />
</div>
<div id="question-15.1" class="section level2">
<h2>Question 1(5.1)</h2>
<ul>
<li>This question I used Antithetic variables to solve this question.</li>
<li><span class="math display">\[ \int_{0}^{\pi /3}sint\ dt =cos\left (0  \right )-cos\left ( \frac{\pi }{3} \right )=0.5\]</span></li>
<li>The exact value of the integral is 0.5.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">n=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb15-2" title="2">x=<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span>pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-3" title="3">theta_hat1=<span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">theta_hat2=<span class="kw">mean</span>(<span class="kw">sin</span>(pi<span class="op">/</span><span class="dv">3</span><span class="op">-</span>x))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb15-5" title="5">theta_hat=<span class="kw">mean</span>(<span class="kw">c</span>(theta_hat1,theta_hat2))</a>
<a class="sourceLine" id="cb15-6" title="6"><span class="kw">print</span>(<span class="kw">c</span>(theta_hat1,theta_hat2))</a></code></pre></div>
<pre><code>## [1] 0.4979243 0.5023719</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">print</span>(theta_hat)</a></code></pre></div>
<pre><code>## [1] 0.5001481</code></pre>
<ul>
<li>The error is -1.481266310^{-4}.</li>
</ul>
<hr />
</div>
<div id="question-25.10" class="section level2">
<h2>Question 2(5.10)</h2>
<ul>
<li>This method is my initial idea, but the calculation efficiency is very low, but the result is very good.</li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">theta_hat_MC=theta_hat_AhV=<span class="dv">0</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb19-3" title="3">  n=<span class="fl">1e4</span></a>
<a class="sourceLine" id="cb19-4" title="4">  x=<span class="kw">runif</span>(n,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-5" title="5">  theta=<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-6" title="6">  theta_hat_MC[i]=<span class="kw">mean</span>(theta)</a>
<a class="sourceLine" id="cb19-7" title="7">  theta_NI=<span class="kw">exp</span>(<span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>x))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>x)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-8" title="8">  theta_hat_AhV[i]=<span class="kw">mean</span>(<span class="kw">c</span>(theta[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)],theta_NI[<span class="dv">1</span><span class="op">:</span>(n<span class="op">/</span><span class="dv">2</span>)]))</a>
<a class="sourceLine" id="cb19-9" title="9">}</a>
<a class="sourceLine" id="cb19-10" title="10"><span class="kw">c</span>(<span class="kw">sd</span>(theta_hat_MC)<span class="op">^</span><span class="dv">2</span>,<span class="kw">sd</span>(theta_hat_AhV)<span class="op">^</span><span class="dv">2</span>,<span class="kw">sd</span>(theta_hat_AhV)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sd</span>(theta_hat_MC)<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 5.884418e-06 2.226446e-07 3.783630e-02</code></pre>
<ul>
<li>We can apply the ready-made code on P120 of the textbook.</li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb21-2" title="2">  u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,x)</a>
<a class="sourceLine" id="cb21-3" title="3">  <span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span> v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb21-4" title="4">  u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</a>
<a class="sourceLine" id="cb21-5" title="5">  cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb21-6" title="6">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(x)) {</a>
<a class="sourceLine" id="cb21-7" title="7">    g &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb21-8" title="8">    cdf[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(g)</a>
<a class="sourceLine" id="cb21-9" title="9">  }</a>
<a class="sourceLine" id="cb21-10" title="10">  cdf</a>
<a class="sourceLine" id="cb21-11" title="11">}</a>
<a class="sourceLine" id="cb21-12" title="12">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb21-13" title="13">MC1 &lt;-<span class="st"> </span>MC2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb21-14" title="14">x &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb21-16" title="16">  MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb21-17" title="17">  MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x, <span class="dt">R =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb21-18" title="18">}</a>
<a class="sourceLine" id="cb21-19" title="19"></a>
<a class="sourceLine" id="cb21-20" title="20"><span class="kw">c</span>(<span class="kw">sd</span>(MC1)<span class="op">^</span><span class="dv">2</span>,<span class="kw">sd</span>(MC2)<span class="op">^</span><span class="dv">2</span>,<span class="kw">sd</span>(MC2)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="kw">sd</span>(MC1)<span class="op">^</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 5.972661e-05 2.146159e-06 3.593304e-02</code></pre>
<ul>
<li>By calculation,we know the approximate reduction in variance is approximately 0.035</li>
</ul>
<hr />
</div>
<div id="question-35.15" class="section level2">
<h2>Question 3(5.15)</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">M &lt;-<span class="st"> </span><span class="dv">10000</span>; k &lt;-<span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb23-2" title="2">r &lt;-<span class="st"> </span>M<span class="op">/</span>k <span class="co">#replicates per stratum</span></a>
<a class="sourceLine" id="cb23-3" title="3">N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></a>
<a class="sourceLine" id="cb23-4" title="4">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb23-5" title="5">est &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb23-6" title="6">g&lt;-<span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb23-7" title="7"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb23-8" title="8">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) </a>
<a class="sourceLine" id="cb23-9" title="9">    {</a>
<a class="sourceLine" id="cb23-10" title="10">      u=<span class="kw">runif</span>(r,(j<span class="dv">-1</span>)<span class="op">/</span>k,j<span class="op">/</span>k)</a>
<a class="sourceLine" id="cb23-11" title="11">      x =<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb23-12" title="12">      fg &lt;-<span class="st"> </span><span class="kw">g</span>(x)</a>
<a class="sourceLine" id="cb23-13" title="13">      T[j]&lt;-<span class="kw">mean</span>(fg)</a>
<a class="sourceLine" id="cb23-14" title="14">    }</a>
<a class="sourceLine" id="cb23-15" title="15">  est[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(T)</a>
<a class="sourceLine" id="cb23-16" title="16">}</a>
<a class="sourceLine" id="cb23-17" title="17"><span class="kw">mean</span>(est)</a></code></pre></div>
<pre><code>## [1] 0.5247582</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">sd</span>(est)</a></code></pre></div>
<pre><code>## [1] 0.0002015987</code></pre>
<ul>
<li>The mean using the the stratified importance sampling estimate method is 0.5247582,is similar to <span class="math inline">\(\hat{\theta}=0.5257801\)</span></li>
<li>The standard deviation we get using the the stratified importance sampling estimate method is 2.015986910^{-4},the estimated standard error in Example 5.10 is 0.0970314,so the stratified importance sampling estimate method is better in this question.</li>
</ul>
<hr />
</div>
<div id="homework-in-20191018" class="section level2">
<h2>Homework in 20191018</h2>
</div>
<div id="section-2" class="section level2">
<h2>6.5</h2>
<div id="question-2" class="section level3">
<h3>Question</h3>
<ul>
<li>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use aMonte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</li>
</ul>
</div>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb27-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb27-3" title="3">UCL &lt;-<span class="st"> </span>sigma_hat &lt;-<span class="st"> </span>theta_hat &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb27-4" title="4"></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="co">### repete 1000 times</span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb27-7" title="7">{</a>
<a class="sourceLine" id="cb27-8" title="8">  x&lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-9" title="9">  theta_hat[i]=<span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb27-10" title="10">  sigma_hat[i]=<span class="kw">sd</span>(x)</a>
<a class="sourceLine" id="cb27-11" title="11">  UCL[i] &lt;-<span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df=</span>n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb27-12" title="12">}</a>
<a class="sourceLine" id="cb27-13" title="13"></a>
<a class="sourceLine" id="cb27-14" title="14"><span class="co">### t-interval method</span></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="kw">mean</span>(theta_hat<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-2</span>)<span class="op">*</span>sigma_hat<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">&lt;=</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>theta_hat<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-2</span>)<span class="op">*</span>sigma_hat<span class="op">/</span><span class="kw">sqrt</span>(n)<span class="op">&gt;=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## [1] 0.912</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co">### method in example 6.4</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">mean</span>(UCL<span class="op">&gt;=</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.772</code></pre>
<ul>
<li>From the result,we can find t-interval method is better than the method used interval for variance.</li>
</ul>
</div>
</div>
<div id="section-3" class="section level2">
<h2>6.6</h2>
<div id="question-3" class="section level3">
<h3>Question</h3>
<ul>
<li>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}}\approx N(0, 6/n)\)</span>.</li>
</ul>
</div>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb31-2" title="2">rep=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb31-3" title="3">skewness &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb31-4" title="4">q=<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb31-5" title="5"></a>
<a class="sourceLine" id="cb31-6" title="6">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb31-7" title="7"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb31-8" title="8">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb31-9" title="9">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb31-10" title="10">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb31-11" title="11"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb31-12" title="12">}</a>
<a class="sourceLine" id="cb31-13" title="13"></a>
<a class="sourceLine" id="cb31-14" title="14"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>rep){</a>
<a class="sourceLine" id="cb31-15" title="15">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb31-16" title="16">  skewness[i]=<span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb31-17" title="17">}</a>
<a class="sourceLine" id="cb31-18" title="18"></a>
<a class="sourceLine" id="cb31-19" title="19"><span class="co">### the estimated quantiles</span></a>
<a class="sourceLine" id="cb31-20" title="20">cv_hat=<span class="kw">as.vector</span>(<span class="kw">quantile</span>(skewness,q))</a>
<a class="sourceLine" id="cb31-21" title="21">cv_hat</a></code></pre></div>
<pre><code>## [1] -0.9397579 -0.7619464  0.8293611  0.9891285</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">### the real data</span></a>
<a class="sourceLine" id="cb33-2" title="2">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(q,<span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n))</a>
<a class="sourceLine" id="cb33-3" title="3">cv</a></code></pre></div>
<pre><code>## [1] -1.0735165 -0.9009234  0.9009234  1.0735165</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co">### the error is: </span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="dv">1</span><span class="op">-</span>cv_hat<span class="op">/</span>cv</a></code></pre></div>
<pre><code>## [1] 0.12459855 0.15426060 0.07943219 0.07860896</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">### Because we get a small number of skewness, we change the variance of the skewness to 6*(n-2) / ((n+1)*(n+3)</span></a>
<a class="sourceLine" id="cb37-2" title="2">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(q,<span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb37-3" title="3"><span class="co">### Revised cv is</span></a>
<a class="sourceLine" id="cb37-4" title="4">cv</a></code></pre></div>
<pre><code>## [1] -0.9268008 -0.7777958  0.7777958  0.9268008</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co">### the revised error is: </span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="dv">1</span><span class="op">-</span>cv_hat<span class="op">/</span>cv</a></code></pre></div>
<pre><code>## [1] -0.01398043  0.02037721 -0.06629679 -0.06725033</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="co">### The result is much better.</span></a>
<a class="sourceLine" id="cb41-2" title="2"></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="co">### When q=c(0.025,0.05,0.95,0.975),the standard error is</span></a>
<a class="sourceLine" id="cb41-4" title="4">q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>(n<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>cv_hat<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)))</a></code></pre></div>
<pre><code>## [1] 0.007388385 0.010638701 0.011843460 0.008126574</code></pre>
<hr />
</div>
</div>
<div id="homework-in-20191101" class="section level2">
<h2>Homework in 20191101</h2>
</div>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<ul>
<li>Estimate the power of the skewness test of normality against symmetric $Beta(,) distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as t(ν)?</li>
</ul>
</div>
<div id="solution" class="section level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">.1</span></a>
<a class="sourceLine" id="cb43-2" title="2">n &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">100</span>,<span class="dv">2000</span>,<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb43-3" title="3">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb43-4" title="4">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb43-5" title="5"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb43-6" title="6">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb43-7" title="7">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb43-8" title="8">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-9" title="9"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb43-10" title="10">}</a>
<a class="sourceLine" id="cb43-11" title="11">power=<span class="dv">0</span></a>
<a class="sourceLine" id="cb43-12" title="12"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb43-13" title="13">  <span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb43-14" title="14">  cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n[j]<span class="op">-</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>((n[j]<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n[j]<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb43-15" title="15">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb43-16" title="16">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb43-17" title="17">  x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n[j],alpha,alpha)</a>
<a class="sourceLine" id="cb43-18" title="18">  sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb43-19" title="19">  }</a>
<a class="sourceLine" id="cb43-20" title="20">power[j]=<span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb43-21" title="21">}</a>
<a class="sourceLine" id="cb43-22" title="22">power</a></code></pre></div>
<pre><code>##  [1] 0.0384 0.0356 0.0360 0.0388 0.0324 0.0356 0.0404 0.0340 0.0352 0.0352
## [11] 0.0308 0.0324 0.0380 0.0336 0.0324 0.0296 0.0296 0.0288 0.0348 0.0340</code></pre>
<ul>
<li>We can find the power is not good enough,because Beta(2,2) Is symmetrical.I tried to change my n,but it influenced a little.In order to get a better result, I make a contaminated like Example 6.10.But we find the best power is 0.3.</li>
</ul>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">.1</span></a>
<a class="sourceLine" id="cb45-2" title="2">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb45-3" title="3">m &lt;-<span class="st"> </span><span class="dv">2500</span></a>
<a class="sourceLine" id="cb45-4" title="4">epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</a>
<a class="sourceLine" id="cb45-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</a>
<a class="sourceLine" id="cb45-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb45-7" title="7">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb45-8" title="8"><span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb45-9" title="9">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb45-10" title="10">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-11" title="11">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-12" title="12"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb45-13" title="13">}</a>
<a class="sourceLine" id="cb45-14" title="14"><span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb45-15" title="15">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))</a>
<a class="sourceLine" id="cb45-16" title="16"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></a>
<a class="sourceLine" id="cb45-17" title="17">e &lt;-<span class="st"> </span>epsilon[j]</a>
<a class="sourceLine" id="cb45-18" title="18">sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb45-19" title="19"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate</span></a>
<a class="sourceLine" id="cb45-20" title="20">sigma &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb45-21" title="21"><span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</a>
<a class="sourceLine" id="cb45-22" title="22"><span class="co">## x &lt;- rnorm(n, 0, sigma)</span></a>
<a class="sourceLine" id="cb45-23" title="23">x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,sigma,sigma)</a>
<a class="sourceLine" id="cb45-24" title="24">sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</a>
<a class="sourceLine" id="cb45-25" title="25">}</a>
<a class="sourceLine" id="cb45-26" title="26">pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</a>
<a class="sourceLine" id="cb45-27" title="27">}</a>
<a class="sourceLine" id="cb45-28" title="28"><span class="co">#plot power vs epsilon</span></a>
<a class="sourceLine" id="cb45-29" title="29"><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb45-30" title="30"><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb45-31" title="31"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-32" title="32">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></a>
<a class="sourceLine" id="cb45-33" title="33"><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb45-34" title="34"><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<ul>
<li>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^{2}(1)\)</span>, (ii)Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_{0} : μ = \mu_{0}\)</span> vs <span class="math inline">\(H_{1}:μ\neq\mu_{0}\)</span>, where <span class="math inline">\(\mu_{0}\)</span> is the mean of <span class="math inline">\(\chi^{2}_{1}\)</span>, Uniform(0,2), and Exponential(1), respectively.</li>
</ul>
<hr />
</div>
<div id="solution-1" class="section level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb46-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb46-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb46-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb46-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb46-7" title="7">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dt">df=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb46-8" title="8">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0,<span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>))</a>
<a class="sourceLine" id="cb46-9" title="9">p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb46-10" title="10">}</a>
<a class="sourceLine" id="cb46-11" title="11">p.hat1 &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb46-12" title="12"></a>
<a class="sourceLine" id="cb46-13" title="13"></a>
<a class="sourceLine" id="cb46-14" title="14"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb46-15" title="15">x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb46-16" title="16">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x,  <span class="dt">mu =</span> mu0)</a>
<a class="sourceLine" id="cb46-17" title="17">p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb46-18" title="18">}</a>
<a class="sourceLine" id="cb46-19" title="19">p.hat2 &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb46-20" title="20"></a>
<a class="sourceLine" id="cb46-21" title="21"></a>
<a class="sourceLine" id="cb46-22" title="22"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb46-23" title="23">x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, mu0)</a>
<a class="sourceLine" id="cb46-24" title="24">ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu =</span> mu0,<span class="dt">alternative =</span> <span class="kw">c</span>(<span class="st">&quot;two.sided&quot;</span>))</a>
<a class="sourceLine" id="cb46-25" title="25">p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb46-26" title="26">}</a>
<a class="sourceLine" id="cb46-27" title="27">p.hat3 &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb46-28" title="28"><span class="kw">print</span>(<span class="kw">c</span>(p.hat1,p.hat2,p.hat3))</a></code></pre></div>
<pre><code>## [1] 0.1014 0.0523 0.0813</code></pre>
<ul>
<li>We can find that all three p-value&gt;0.5,so we can use t-test in this three cases.We tested that the t-test is robust to mild departures from normality.</li>
</ul>
<hr />
<p>##Question 3 &amp; solution</p>
<ul>
<li>1.We mark the power of method 1 is p1,the power of method2 is p2.The hypothesis test is <span class="math display">\[H_{0}:p_{1}=p_{2}\leftrightarrow H_{1}:p_{1}\neq p_{2}\]</span></li>
<li><ol start="2" style="list-style-type: decimal">
<li>We choose the multipula test</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>When we use multiole test,we only need to know True negative rate,because we know tro power,we can caculate V,S,U,T in the table,then we can do multiple test to test <span class="math inline">\(H_{0}\)</span>.</li>
</ol></li>
</ul>
<hr />
</div>
<div id="homework-in-20191108" class="section level2">
<h2>Homework in 20191108</h2>
</div>
<div id="solution-7.6" class="section level2">
<h2>Solution 7.6</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># get data</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="kw">library</span>(<span class="st">&quot;boot&quot;</span>)</a>
<a class="sourceLine" id="cb48-3" title="3"><span class="kw">data</span>(scor,<span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb48-4" title="4"><span class="co"># the scatter plots</span></a>
<a class="sourceLine" id="cb48-5" title="5"><span class="kw">pairs</span>(scor)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># the sample correlation matrix</span></a>
<a class="sourceLine" id="cb49-2" title="2">scm=<span class="kw">cor</span>(scor)</a>
<a class="sourceLine" id="cb49-3" title="3">scm</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co">##  Question 1:Compare the plot with the sample correlation matrix.</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="co">##  We can find that the larger the correlation coefficient in the sample matrix, the denser the point in the plot.</span></a>
<a class="sourceLine" id="cb51-3" title="3"></a>
<a class="sourceLine" id="cb51-4" title="4"><span class="co"># For convenience, I used the boot function directly.</span></a>
<a class="sourceLine" id="cb51-5" title="5">r=<span class="st"> </span><span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb51-6" title="6"> <span class="kw">c</span>(<span class="kw">cor</span>(x[i,<span class="dv">1</span>], x[i,<span class="dv">3</span>]),<span class="kw">cor</span>(x[i,<span class="dv">3</span>], x[i,<span class="dv">4</span>]),<span class="kw">cor</span>(x[i,<span class="dv">3</span>], x[i,<span class="dv">5</span>]),<span class="kw">cor</span>(x[i,<span class="dv">4</span>], x[i,<span class="dv">5</span>]))</a>
<a class="sourceLine" id="cb51-7" title="7">}</a>
<a class="sourceLine" id="cb51-8" title="8"></a>
<a class="sourceLine" id="cb51-9" title="9">obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> scor, <span class="dt">statistic =</span> r, <span class="dt">R =</span> <span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb51-10" title="10"><span class="co"># The result of bootstrap.</span></a>
<a class="sourceLine" id="cb51-11" title="11">obj</a></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = scor, statistic = r, R = 2000)
## 
## 
## Bootstrap Statistics :
##      original        bias    std. error
## t1* 0.5467511 -0.0019059311  0.08654499
## t2* 0.7108059 -0.0005100336  0.04949428
## t3* 0.6647357 -0.0000874946  0.06126703
## t4* 0.6071743 -0.0002257145  0.07032172</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># The standard error of four correlation is 0.08901265,0.04783641,0.06002932,0.06718623.rho12 is the maximal,and the rho 34 is the minimum.</span></a></code></pre></div>
</div>
<div id="solution-7.b" class="section level2">
<h2>Solution 7.B</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">library</span>(<span class="st">&quot;boot&quot;</span>)</a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3">func.boot &lt;-<span class="cf">function</span>(x,i) {</a>
<a class="sourceLine" id="cb54-4" title="4">  <span class="co">#computes the sample skewness coeff.</span></a>
<a class="sourceLine" id="cb54-5" title="5">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb54-6" title="6">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb54-7" title="7">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb54-8" title="8">  <span class="kw">return</span>( m3<span class="op">/</span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb54-9" title="9">}</a>
<a class="sourceLine" id="cb54-10" title="10">norm=<span class="dv">0</span></a>
<a class="sourceLine" id="cb54-11" title="11">norm.left=norm.right=basic.left=basic.right=perc.left=perc.right=<span class="dv">0</span></a>
<a class="sourceLine" id="cb54-12" title="12"></a>
<a class="sourceLine" id="cb54-13" title="13"><span class="co"># get three  proportions of normal distribution.</span></a>
<a class="sourceLine" id="cb54-14" title="14">m=<span class="dv">0</span></a>
<a class="sourceLine" id="cb54-15" title="15"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">500</span>){</a>
<a class="sourceLine" id="cb54-16" title="16">  nor=<span class="kw">rnorm</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb54-17" title="17">    obj.nor =<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> nor, <span class="dt">statistic =</span> func.boot, <span class="dt">R =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb54-18" title="18">  CI=<span class="kw">boot.ci</span>(<span class="dt">boot.out =</span> obj.nor, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb54-19" title="19">  norm[i]&lt;-m<span class="op">&gt;=</span>CI<span class="op">$</span>normal[<span class="dv">2</span>]<span class="op">&amp;</span>m<span class="op">&lt;=</span>CI<span class="op">$</span>normal[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb54-20" title="20">  norm.left[i]=m<span class="op">&lt;</span>CI<span class="op">$</span>normal[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb54-21" title="21">  norm.right[i]=m<span class="op">&gt;</span>CI<span class="op">$</span>normal[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb54-22" title="22">  basic.left[i]=m<span class="op">&lt;</span>CI<span class="op">$</span>basic[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb54-23" title="23">  basic.right[i]=m<span class="op">&gt;</span>CI<span class="op">$</span>basic[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb54-24" title="24">  perc.left[i]=m<span class="op">&lt;</span>CI<span class="op">$</span>perc[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb54-25" title="25">  perc.right[i]=m<span class="op">&gt;</span>CI<span class="op">$</span>perc[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb54-26" title="26">}</a>
<a class="sourceLine" id="cb54-27" title="27">left.norm=<span class="kw">c</span>(<span class="kw">mean</span>(norm.left),<span class="kw">mean</span>(basic.left),<span class="kw">mean</span>(perc.left))</a>
<a class="sourceLine" id="cb54-28" title="28">right.norm=<span class="kw">c</span>(<span class="kw">mean</span>(norm.right),<span class="kw">mean</span>(basic.right),<span class="kw">mean</span>(perc.right))</a>
<a class="sourceLine" id="cb54-29" title="29"></a>
<a class="sourceLine" id="cb54-30" title="30"><span class="co"># get three proportions of Chi-square distribution</span></a>
<a class="sourceLine" id="cb54-31" title="31">m=<span class="dv">4</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb54-32" title="32"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">500</span>){</a>
<a class="sourceLine" id="cb54-33" title="33">  chi=<span class="kw">rchisq</span>(<span class="dv">10</span>,<span class="dt">df=</span><span class="dv">5</span>,<span class="dt">ncp=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb54-34" title="34">  obj.nor =<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> chi, <span class="dt">statistic =</span> func.boot, <span class="dt">R =</span> <span class="dv">999</span>)</a>
<a class="sourceLine" id="cb54-35" title="35">  CI=<span class="kw">boot.ci</span>(<span class="dt">boot.out =</span> obj.nor, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb54-36" title="36">  norm[i]=m<span class="op">&gt;=</span>CI<span class="op">$</span>normal[<span class="dv">2</span>]<span class="op">&amp;</span>m<span class="op">&lt;=</span>CI<span class="op">$</span>normal[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb54-37" title="37">  norm.left[i]=m<span class="op">&lt;</span>CI<span class="op">$</span>normal[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb54-38" title="38">  norm.right[i]=m<span class="op">&gt;</span>CI<span class="op">$</span>normal[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb54-39" title="39">  basic.left[i]=m<span class="op">&lt;</span>CI<span class="op">$</span>basic[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb54-40" title="40">  basic.right[i]=m<span class="op">&gt;</span>CI<span class="op">$</span>basic[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb54-41" title="41">  perc.left[i]=m<span class="op">&lt;</span>CI<span class="op">$</span>perc[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb54-42" title="42">  perc.right[i]=m<span class="op">&gt;</span>CI<span class="op">$</span>perc[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb54-43" title="43">}</a>
<a class="sourceLine" id="cb54-44" title="44">left.chi=<span class="kw">c</span>(<span class="kw">mean</span>(norm.left),<span class="kw">mean</span>(basic.left),<span class="kw">mean</span>(perc.left))</a>
<a class="sourceLine" id="cb54-45" title="45">right.chi=<span class="kw">c</span>(<span class="kw">mean</span>(norm.right),<span class="kw">mean</span>(basic.right),<span class="kw">mean</span>(perc.right))</a>
<a class="sourceLine" id="cb54-46" title="46"></a>
<a class="sourceLine" id="cb54-47" title="47"><span class="co"># the answer of normal distribution</span></a>
<a class="sourceLine" id="cb54-48" title="48"><span class="kw">data.frame</span>(left.norm,<span class="dt">time.norm=</span><span class="dv">1</span><span class="op">-</span>left.norm<span class="op">-</span>right.norm,right.norm,<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a></code></pre></div>
<pre><code>##       left.norm time.norm right.norm
## norm      0.052     0.896      0.052
## basic     0.056     0.886      0.058
## perc      0.000     1.000      0.000</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># the answer of chi-square distribution</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">data.frame</span>(left.chi,<span class="dt">time.chi=</span><span class="dv">1</span><span class="op">-</span>left.chi<span class="op">-</span>right.chi,right.chi,<span class="dt">row.names=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a></code></pre></div>
<pre><code>##       left.chi time.chi right.chi
## norm     0.004    0.768     0.228
## basic    0.028    0.748     0.224
## perc     0.000    0.740     0.260</code></pre>
<hr />
</div>
<div id="homework-in-20191115" class="section level2">
<h2>Homework in 20191115</h2>
</div>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<ul>
<li>Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat\theta\)</span>.</li>
</ul>
</div>
<div id="solution-7.8" class="section level2">
<h2>Solution 7.8</h2>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="co"># get data</span></a>
<a class="sourceLine" id="cb58-2" title="2"><span class="kw">library</span>(<span class="st">&quot;boot&quot;</span>)</a>
<a class="sourceLine" id="cb58-3" title="3"><span class="kw">data</span>(scor,<span class="dt">package =</span> <span class="st">&quot;bootstrap&quot;</span>)</a>
<a class="sourceLine" id="cb58-4" title="4"><span class="co"># the correlation matrix</span></a>
<a class="sourceLine" id="cb58-5" title="5">sigma=<span class="kw">cov</span>(scor)</a>
<a class="sourceLine" id="cb58-6" title="6"><span class="co"># the function to caculate theta</span></a>
<a class="sourceLine" id="cb58-7" title="7">gettheta=<span class="cf">function</span>(sigma){</a>
<a class="sourceLine" id="cb58-8" title="8">  eigenvalues=<span class="kw">eigen</span>(sigma)<span class="op">$</span>values</a>
<a class="sourceLine" id="cb58-9" title="9">  theta=<span class="kw">max</span>(eigenvalues)<span class="op">/</span><span class="kw">sum</span>(eigenvalues)</a>
<a class="sourceLine" id="cb58-10" title="10">  theta</a>
<a class="sourceLine" id="cb58-11" title="11">}</a>
<a class="sourceLine" id="cb58-12" title="12"><span class="co"># the sample estimate of theta is </span></a>
<a class="sourceLine" id="cb58-13" title="13">theta.hat=<span class="kw">gettheta</span>(sigma)</a>
<a class="sourceLine" id="cb58-14" title="14"><span class="kw">print</span>(theta.hat)</a></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="co"># do the jackknife</span></a>
<a class="sourceLine" id="cb60-2" title="2">n=<span class="kw">length</span>(scor[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb60-3" title="3">theta &lt;-<span class="st"> </span>scor.jack &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb60-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n)</a>
<a class="sourceLine" id="cb60-5" title="5">{</a>
<a class="sourceLine" id="cb60-6" title="6">  scor.jack=scor[<span class="op">-</span>i,]</a>
<a class="sourceLine" id="cb60-7" title="7">  theta[i]=<span class="kw">gettheta</span>(<span class="kw">cov</span>(scor.jack))</a>
<a class="sourceLine" id="cb60-8" title="8">}</a>
<a class="sourceLine" id="cb60-9" title="9"><span class="co"># the bias is</span></a>
<a class="sourceLine" id="cb60-10" title="10">bias=(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta)<span class="op">-</span>theta.hat)</a>
<a class="sourceLine" id="cb60-11" title="11"><span class="kw">print</span>(<span class="kw">round</span>(bias,<span class="dv">6</span>))</a></code></pre></div>
<pre><code>## [1] 0.001069</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># the standard error</span></a>
<a class="sourceLine" id="cb62-2" title="2">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.hat<span class="op">-</span><span class="kw">mean</span>(theta))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb62-3" title="3">se &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">var</span>(theta)<span class="op">/</span>n)</a>
<a class="sourceLine" id="cb62-4" title="4"><span class="kw">print</span>(<span class="kw">round</span>(se,<span class="dv">4</span>))</a></code></pre></div>
<pre><code>## [1] 0.0496</code></pre>
</div>
<div id="question-7.10" class="section level2">
<h2>Question 7.10</h2>
<ul>
<li>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</li>
</ul>
</div>
<div id="solution-7.10" class="section level2">
<h2>Solution 7.10</h2>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="kw">library</span>(lattice)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb70-2" title="2">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb70-3" title="3">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb70-4" title="4">r1 &lt;-<span class="st"> </span>r2 &lt;-<span class="st"> </span>r3 &lt;-<span class="st"> </span>r4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb70-5" title="5"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb70-6" title="6"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb70-7" title="7"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb70-8" title="8">y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb70-9" title="9">x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb70-10" title="10">J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb70-11" title="11">yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb70-12" title="12">e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb70-13" title="13">r1[k] &lt;-<span class="st"> </span><span class="kw">summary</span>(J1)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb70-14" title="14">J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb70-15" title="15">yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb70-16" title="16">e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb70-17" title="17">r2[k] &lt;-<span class="st"> </span><span class="kw">summary</span>(J2)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb70-18" title="18">J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb70-19" title="19">logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb70-20" title="20">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb70-21" title="21">e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb70-22" title="22">r3[k] &lt;-<span class="st"> </span><span class="kw">summary</span>(J3)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb70-23" title="23">J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb70-24" title="24">yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb70-25" title="25">e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb70-26" title="26">r4[k] &lt;-<span class="st"> </span><span class="kw">summary</span>(J4)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb70-27" title="27">}</a>
<a class="sourceLine" id="cb70-28" title="28"><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co"># From the result,we can find the $e_{2}^{2}$ is the minimum.According to the prediction error criterion, Model 2, the quadratic modelwould be the best fit for the data.</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">c</span>(<span class="kw">mean</span>(r1), <span class="kw">mean</span>(r2), <span class="kw">mean</span>(r3), <span class="kw">mean</span>(r4))</a></code></pre></div>
<pre><code>## [1] 0.5279975 0.5765627 0.5279427 0.5736991</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="co"># From the result,we can find the$R_{1}^{2}$ is the maximum.According to maximum adjusted, the quadratic modelwould be the best fit for the data.</span></a></code></pre></div>
<ul>
<li>From the result,we can find the <span class="math inline">\(e_{2}^{2}\)</span> is the minimum.According to the prediction error criterion, Model 2, the quadratic modelwould be the best fit for the data.</li>
<li>From the result,we can find the<span class="math inline">\(R_{2}^{2}\)</span> is the maximum.According to maximum adjusted, the quadratic modelwould be the best fit for the data.</li>
</ul>
<hr />
</div>
<div id="homework-in-20191129" class="section level2">
<h2>Homework in 20191129</h2>
</div>
<div id="question-9.4" class="section level2">
<h2>Question 9.4</h2>
<ul>
<li>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</li>
</ul>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(x)   <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))  </a>
<a class="sourceLine" id="cb75-2" title="2"></a>
<a class="sourceLine" id="cb75-3" title="3">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</a>
<a class="sourceLine" id="cb75-4" title="4">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb75-5" title="5">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb75-6" title="6">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb75-7" title="7">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb75-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb75-9" title="9">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb75-10" title="10"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb75-11" title="11">x[i] &lt;-<span class="st"> </span>y <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb75-12" title="12">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb75-13" title="13">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb75-14" title="14">}</a>
<a class="sourceLine" id="cb75-15" title="15">}</a>
<a class="sourceLine" id="cb75-16" title="16"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb75-17" title="17">}</a>
<a class="sourceLine" id="cb75-18" title="18">n &lt;-<span class="st"> </span><span class="dv">4</span> <span class="co">#degrees of freedom for target Student t dist.</span></a>
<a class="sourceLine" id="cb75-19" title="19">N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb75-20" title="20">sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb75-21" title="21">x0 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb75-22" title="22">rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb75-23" title="23">rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb75-24" title="24">rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb75-25" title="25">rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb75-26" title="26"><span class="co"># print the reject rate</span></a>
<a class="sourceLine" id="cb75-27" title="27"><span class="kw">print</span>(<span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)<span class="op">/</span><span class="dv">2000</span>)</a></code></pre></div>
<pre><code>## [1] 0.0190 0.1585 0.4930 0.8915</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1">no.reject &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">no.reject=</span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</a>
<a class="sourceLine" id="cb77-2" title="2">knitr<span class="op">::</span><span class="kw">kable</span>(no.reject,<span class="dt">format=</span><span class="st">&#39;latex&#39;</span>)</a></code></pre></div>

<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb78-2" title="2">   <span class="co">#display 4 graphs together</span></a>
<a class="sourceLine" id="cb78-3" title="3">    refline &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>), <span class="dt">df=</span>n)</a>
<a class="sourceLine" id="cb78-4" title="4">    rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb78-5" title="5">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb78-6" title="6">        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb78-7" title="7">             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb78-8" title="8">             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb78-9" title="9">        <span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb78-10" title="10">    }</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">     <span class="co">#reset to default</span></a></code></pre></div>
<hr />
</div>
<div id="homework-in-20191206" class="section level2">
<h2>Homework in 20191206</h2>
</div>
<div id="question-111" class="section level2">
<h2>Question 11,1</h2>
<ul>
<li>The natural logarithm and exponential functions are inverses of each other,so that mathematically log(exp x) = exp(logx) = x. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality?</li>
</ul>
</div>
<div id="solution-11.1" class="section level2">
<h2>Solution 11.1</h2>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="co"># the function f is use&quot;==&quot; to judge if log(exp x) = exp(logx) = x</span></a>
<a class="sourceLine" id="cb80-2" title="2">f=<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb80-3" title="3">  a=<span class="kw">log</span>(<span class="kw">exp</span>(x))<span class="op">==</span><span class="kw">exp</span>(<span class="kw">log</span>(x))</a>
<a class="sourceLine" id="cb80-4" title="4">  b=<span class="kw">log</span>(<span class="kw">exp</span>(x))<span class="op">==</span>x</a>
<a class="sourceLine" id="cb80-5" title="5">  c=<span class="kw">exp</span>(<span class="kw">log</span>(x))<span class="op">==</span>x</a>
<a class="sourceLine" id="cb80-6" title="6">  a<span class="op">+</span>b<span class="op">+</span>c<span class="op">==</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb80-7" title="7">}</a>
<a class="sourceLine" id="cb80-8" title="8"><span class="kw">f</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>##  [1]  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">10</span>))<span class="op">-</span><span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">10</span>))</a></code></pre></div>
<pre><code>## [1] -1.776357e-15</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">10</span>))<span class="op">-</span><span class="dv">10</span></a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">10</span>))<span class="op">-</span><span class="dv">10</span></a></code></pre></div>
<pre><code>## [1] 1.776357e-15</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co"># We can find the example show the caculation about exp(log(x)) may be wrong.</span></a>
<a class="sourceLine" id="cb88-2" title="2"></a>
<a class="sourceLine" id="cb88-3" title="3"><span class="co"># the function g is use all.equal to judge if log(exp x) = exp(logx) = x</span></a>
<a class="sourceLine" id="cb88-4" title="4">g=<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb88-5" title="5">  <span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x)),<span class="kw">exp</span>(<span class="kw">log</span>(x)),x)</a>
<a class="sourceLine" id="cb88-6" title="6">}</a>
<a class="sourceLine" id="cb88-7" title="7"><span class="kw">g</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co"># There are no errors.</span></a></code></pre></div>
</div>
<div id="solution-11.5" class="section level2">
<h2>Solution 11.5</h2>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">root<span class="fl">.114</span> &lt;-<span class="st"> </span>root<span class="fl">.115</span> &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb91-2" title="2">k&lt;-<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb91-3" title="3"></a>
<a class="sourceLine" id="cb91-4" title="4"><span class="co"># caculate the root in 11.4</span></a>
<a class="sourceLine" id="cb91-5" title="5">f1=<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb91-6" title="6">  <span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k)<span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),<span class="dt">df=</span>k<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb91-7" title="7">}</a>
<a class="sourceLine" id="cb91-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>){</a>
<a class="sourceLine" id="cb91-9" title="9">  root<span class="fl">.114</span>[i]=<span class="kw">uniroot</span>(f1,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">0.01</span>),<span class="dt">k=</span>k[i])<span class="op">$</span>root</a>
<a class="sourceLine" id="cb91-10" title="10">}</a>
<a class="sourceLine" id="cb91-11" title="11"></a>
<a class="sourceLine" id="cb91-12" title="12"></a>
<a class="sourceLine" id="cb91-13" title="13"></a>
<a class="sourceLine" id="cb91-14" title="14"><span class="co"># caculate the root in 11.5</span></a>
<a class="sourceLine" id="cb91-15" title="15">ck=<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb91-16" title="16">  <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb91-17" title="17">}</a>
<a class="sourceLine" id="cb91-18" title="18"></a>
<a class="sourceLine" id="cb91-19" title="19"><span class="co"># equation function in 11.5</span></a>
<a class="sourceLine" id="cb91-20" title="20">f2=<span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb91-21" title="21">  <span class="kw">log</span>(<span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="kw">log</span>(pi<span class="op">*</span>(k<span class="dv">-1</span>))<span class="op">-</span><span class="kw">lgamma</span>((k<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(<span class="kw">integrate</span>(<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(k<span class="dv">-1</span>))<span class="op">^</span>(<span class="op">-</span>k<span class="op">/</span><span class="dv">2</span>)},<span class="dv">0</span>,<span class="kw">ck</span>(a,k<span class="dv">-1</span>))<span class="op">$</span>value)<span class="op">-</span>(<span class="kw">log</span>(<span class="dv">2</span>)<span class="op">+</span><span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span><span class="kw">log</span>(pi<span class="op">*</span>k)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(<span class="kw">integrate</span>(<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)},<span class="dv">0</span>,<span class="kw">ck</span>(a,k))<span class="op">$</span>value))</a>
<a class="sourceLine" id="cb91-22" title="22">}</a>
<a class="sourceLine" id="cb91-23" title="23"></a>
<a class="sourceLine" id="cb91-24" title="24"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">22</span>){</a>
<a class="sourceLine" id="cb91-25" title="25">  root<span class="fl">.115</span>[i]=<span class="kw">uniroot</span>(f2,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,root<span class="fl">.114</span>[i]<span class="op">+</span><span class="fl">0.0001</span>),<span class="dt">k=</span>k[i])<span class="op">$</span>root</a>
<a class="sourceLine" id="cb91-26" title="26">}</a>
<a class="sourceLine" id="cb91-27" title="27"></a>
<a class="sourceLine" id="cb91-28" title="28"><span class="co">## Note: When k is large, the value range of the uniroot function must be fine, otherwise the two ends of the interval are likely to have the same number. So I set the upper bound separately for k = 100, 500, 1000 </span></a>
<a class="sourceLine" id="cb91-29" title="29">root<span class="fl">.115</span>[<span class="dv">23</span>]=<span class="kw">uniroot</span>(f2,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="fl">9.98</span>),<span class="dt">k=</span>k[<span class="dv">23</span>])<span class="op">$</span>root</a>
<a class="sourceLine" id="cb91-30" title="30">root<span class="fl">.115</span>[<span class="dv">24</span>]=<span class="kw">uniroot</span>(f2,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="kw">sqrt</span>(k[<span class="dv">24</span>])<span class="op">-</span><span class="fl">0.03</span>),<span class="dt">k=</span>k[<span class="dv">24</span>])<span class="op">$</span>root</a>
<a class="sourceLine" id="cb91-31" title="31">root<span class="fl">.115</span>[<span class="dv">25</span>]=<span class="kw">uniroot</span>(f2,<span class="dt">interval =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="kw">sqrt</span>(k[<span class="dv">25</span>]<span class="op">-</span><span class="dv">1</span>)),<span class="dt">k=</span>k[<span class="dv">25</span>])<span class="op">$</span>root</a>
<a class="sourceLine" id="cb91-32" title="32"></a>
<a class="sourceLine" id="cb91-33" title="33">root<span class="fl">.114</span> <span class="co">#the result in 11.4</span></a></code></pre></div>
<pre><code>##  [1]  1.492104  1.533558  1.562746  1.584452  1.601189  1.614507  1.625383
##  [8]  1.634436  1.642028  1.648539  1.654179  1.659097  1.663434  1.667285
## [15]  1.670721  1.673818  1.676602  1.679153  1.681470  4.785832  4.888979
## [22]  4.990000  9.990000 22.350680 31.612777</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">root<span class="fl">.115</span> <span class="co">#the result in 11.5</span></a></code></pre></div>
<pre><code>##  [1]  1.492103  1.533559  1.562745  1.584429  1.601182  1.614517  1.625383
##  [8]  1.634409  1.642026  1.648540  1.654174  1.659096  1.663433  1.667283
## [15]  1.670724  1.673817  1.676614  1.679154  1.681471  1.683594  1.685547
## [22]  1.687348  1.720597 19.490100 31.421896</code></pre>
<ul>
<li>We found that using the method of 11.4 to estimate k = 23,24,25 is very inaccurate, but the method of 11.5 lacks a good solution to this problem.</li>
</ul>
</div>
<div id="solution-3" class="section level2">
<h2>Solution 3</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb95-2" title="2">p &lt;-<span class="st"> </span>q &lt;-<span class="st"> </span><span class="fl">0.1</span></a>
<a class="sourceLine" id="cb95-3" title="3">r=<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</a>
<a class="sourceLine" id="cb95-4" title="4">lf &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb95-5" title="5"></a>
<a class="sourceLine" id="cb95-6" title="6">LF=<span class="cf">function</span>(AA,BB,p,q){ <span class="co">#log-likelyhood function</span></a>
<a class="sourceLine" id="cb95-7" title="7">  a=(<span class="dv">28</span><span class="op">-</span>AA)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>AA<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>(<span class="dv">24</span><span class="op">-</span>BB)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span>BB<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">70</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)<span class="op">+</span><span class="dv">2</span><span class="op">*</span><span class="dv">41</span><span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb95-8" title="8">  <span class="kw">return</span>(a)</a>
<a class="sourceLine" id="cb95-9" title="9">}</a>
<a class="sourceLine" id="cb95-10" title="10"></a>
<a class="sourceLine" id="cb95-11" title="11">iter&lt;-<span class="cf">function</span>(p,q){</a>
<a class="sourceLine" id="cb95-12" title="12">  r&lt;-<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</a>
<a class="sourceLine" id="cb95-13" title="13">  a&lt;-<span class="dv">2</span><span class="op">*</span><span class="dv">28</span><span class="op">*</span>(p<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r<span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">*</span><span class="dv">28</span><span class="op">+</span><span class="dv">70</span></a>
<a class="sourceLine" id="cb95-14" title="14">  b&lt;-<span class="dv">2</span><span class="op">*</span><span class="dv">24</span><span class="op">*</span>(q<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r<span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">*</span><span class="dv">24</span><span class="op">+</span><span class="dv">70</span></a>
<a class="sourceLine" id="cb95-15" title="15">  c&lt;-<span class="dv">2</span><span class="op">*</span><span class="dv">41</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r<span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">*</span><span class="dv">28</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r<span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">*</span><span class="dv">24</span></a>
<a class="sourceLine" id="cb95-16" title="16">  <span class="kw">return</span>(<span class="kw">c</span>(a<span class="op">/</span>(a<span class="op">+</span>b<span class="op">+</span>c),b<span class="op">/</span>(a<span class="op">+</span>b<span class="op">+</span>c)))</a>
<a class="sourceLine" id="cb95-17" title="17">}</a>
<a class="sourceLine" id="cb95-18" title="18"></a>
<a class="sourceLine" id="cb95-19" title="19">AA=<span class="kw">sum</span>(<span class="kw">rbinom</span>(<span class="dv">28</span>,<span class="dv">1</span>,(p<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r))))</a>
<a class="sourceLine" id="cb95-20" title="20">BB=<span class="kw">sum</span>(<span class="kw">rbinom</span>(<span class="dv">24</span>,<span class="dv">1</span>,(q<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r))))</a>
<a class="sourceLine" id="cb95-21" title="21">lf=<span class="kw">LF</span>(AA,BB,p,q)</a>
<a class="sourceLine" id="cb95-22" title="22"></a>
<a class="sourceLine" id="cb95-23" title="23"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>){</a>
<a class="sourceLine" id="cb95-24" title="24">  m=<span class="kw">iter</span>(p[i],q[i])</a>
<a class="sourceLine" id="cb95-25" title="25">  p[i<span class="op">+</span><span class="dv">1</span>]=m[<span class="dv">1</span>];q[i<span class="op">+</span><span class="dv">1</span>]=m[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb95-26" title="26">  AA=<span class="kw">sum</span>(<span class="kw">rbinom</span>(<span class="dv">28</span>,<span class="dv">1</span>,(p[i<span class="op">+</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(p[i<span class="op">+</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>r))))</a>
<a class="sourceLine" id="cb95-27" title="27">  BB=<span class="kw">sum</span>(<span class="kw">rbinom</span>(<span class="dv">24</span>,<span class="dv">1</span>,(q[i<span class="op">+</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(q[i<span class="op">+</span><span class="dv">1</span>]<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q[i<span class="op">+</span><span class="dv">1</span>]<span class="op">*</span>r))))</a>
<a class="sourceLine" id="cb95-28" title="28">  lf[i<span class="op">+</span><span class="dv">1</span>]=<span class="kw">LF</span>(AA,BB,p[i<span class="op">+</span><span class="dv">1</span>],q[i<span class="op">+</span><span class="dv">1</span>])</a>
<a class="sourceLine" id="cb95-29" title="29">  <span class="cf">if</span>(<span class="kw">abs</span>(p[i<span class="op">+</span><span class="dv">1</span>]<span class="op">-</span>p[i])<span class="op">&lt;=</span><span class="fl">1e-4</span>) <span class="cf">break</span></a>
<a class="sourceLine" id="cb95-30" title="30">}</a>
<a class="sourceLine" id="cb95-31" title="31"></a>
<a class="sourceLine" id="cb95-32" title="32">p</a></code></pre></div>
<pre><code>## [1] 0.1000000 0.3056658 0.3242869 0.3268970 0.3272785 0.3273346</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">q</a></code></pre></div>
<pre><code>## [1] 0.1000000 0.2926741 0.3080029 0.3100750 0.3103751 0.3104191</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">plot</span>(lf,<span class="dt">type=</span><span class="st">&quot;o&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;n&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;LF&quot;</span>,<span class="dt">main=</span><span class="st">&quot;The plot of log-likelyhood function&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>In fact, I think the number of this topic is not strict. It is known that n (AB) = 70, n (OO) = 41, n = 163, which is also in line with HWE. It is difficult to find a suitable p, q for him Better fit this model.</li>
</ul>
<hr />
</div>
<div id="homework-in-20191213" class="section level2">
<h2>Homework in 20191213</h2>
</div>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<ul>
<li>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</li>
</ul>
</div>
<div id="solution-1-1" class="section level2">
<h2>Solution 1</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">formulas =<span class="kw">list</span>(mpg <span class="op">~</span><span class="st"> </span>disp,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="co"># lapply() to fit linear models</span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="kw">lapply</span>(formulas,lm,<span class="dt">data=</span>mtcars)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]], data = ..1)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">a&lt;-<span class="kw">list</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb102-2" title="2"><span class="kw">length</span>(a)&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb102-3" title="3"><span class="co"># for loop to fit linear models</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb102-5" title="5">  a[[i]]=<span class="kw">lm</span>(<span class="dt">formula =</span> formulas[[i]],<span class="dt">data=</span>mtcars)</a>
<a class="sourceLine" id="cb102-6" title="6">}</a>
<a class="sourceLine" id="cb102-7" title="7">a</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<ul>
<li>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function? bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</li>
</ul>
</div>
<div id="solution-2" class="section level2">
<h2>Solution 2</h2>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb104-2" title="2">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb104-3" title="3">mtcars[rows, ]</a>
<a class="sourceLine" id="cb104-4" title="4">})</a>
<a class="sourceLine" id="cb104-5" title="5"><span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.20160     -0.04156  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.33457     -0.03741  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.88458     -0.03984  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.94355     -0.04208  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.85994     -0.04387  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.10830     -0.03455  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.17782     -0.03484  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.65000     -0.04146  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.74840     -0.03908  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##     29.2855      -0.0385</code></pre>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<ul>
<li>For each model in the previous two exercises, extract R2 using the function below. rsq &lt;- function(mod) summary(mod)$r.squared</li>
</ul>
</div>
<div id="solution-3-1" class="section level2">
<h2>Solution 3</h2>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="co"># the function</span></a>
<a class="sourceLine" id="cb106-2" title="2">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb106-3" title="3">formulas =<span class="kw">list</span>(mpg <span class="op">~</span><span class="st"> </span>disp,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb106-4" title="4"><span class="co"># lapply() to fit linear models</span></a>
<a class="sourceLine" id="cb106-5" title="5">a=<span class="kw">lapply</span>(formulas,lm,<span class="dt">data=</span>mtcars)</a>
<a class="sourceLine" id="cb106-6" title="6">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb106-7" title="7">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb106-8" title="8">mtcars[rows, ]</a>
<a class="sourceLine" id="cb106-9" title="9">})</a>
<a class="sourceLine" id="cb106-10" title="10">b=<span class="kw">lapply</span>(bootstraps,lm,<span class="dt">formula=</span>mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb106-11" title="11"><span class="co"># r^2 in Question 1</span></a>
<a class="sourceLine" id="cb106-12" title="12"><span class="kw">lapply</span>(a, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="co"># r^2 in Question 2</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="kw">lapply</span>(b, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7807689
## 
## [[2]]
## [1] 0.6643146
## 
## [[3]]
## [1] 0.7457081
## 
## [[4]]
## [1] 0.7637815
## 
## [[5]]
## [1] 0.8145855
## 
## [[6]]
## [1] 0.6971955
## 
## [[7]]
## [1] 0.8031412
## 
## [[8]]
## [1] 0.8037138
## 
## [[9]]
## [1] 0.7397875
## 
## [[10]]
## [1] 0.700006</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<ul>
<li>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE ) Extra challenge: get rid of the anonymous function by using [[ directly.</li>
</ul>
</div>
<div id="solution-4" class="section level2">
<h2>Solution 4</h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb110-2" title="2"><span class="kw">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 0.10599611 0.03711881 0.77183098 0.02347388 0.55142969 0.96544609
##   [7] 0.60425475 0.54001778 0.07009208 0.62865611 0.13411398 0.16487915
##  [13] 0.13402049 0.98710840 0.50764079 0.03341741 0.50613058 0.73978891
##  [19] 0.60907458 0.43579974 0.16792036 0.04500086 0.47322209 0.08892749
##  [25] 0.32674030 0.26925152 0.73536908 0.33504031 0.46619458 0.20936246
##  [31] 0.29723196 0.48056112 0.97382001 0.01397090 0.01891176 0.24466680
##  [37] 0.05289983 0.61005067 0.26282882 0.35789687 0.43812334 0.80374651
##  [43] 0.89207977 0.79875887 0.13296491 0.67252696 0.04597314 0.74735569
##  [49] 0.68063373 0.52343998 0.72020895 0.25883715 0.09622342 0.37684525
##  [55] 0.24836912 0.79693926 0.45699557 0.88475421 0.65811655 0.75295695
##  [61] 0.46395950 0.47361626 0.37915832 0.47370144 0.48530956 0.93288660
##  [67] 0.47696515 0.21400849 0.44347594 0.64331581 0.30614998 0.20914298
##  [73] 0.98700790 0.49716423 0.18916520 0.18851628 0.29275205 0.66549287
##  [79] 0.90660666 0.36387514 0.88141847 0.95613844 0.04984235 0.83483844
##  [85] 0.41149077 0.65999998 0.21832446 0.59156447 0.37084773 0.49619350
##  [91] 0.98593668 0.16167999 0.84588653 0.06291973 0.07935894 0.98060347
##  [97] 0.48500500 0.87112397 0.73094899 0.81477829</code></pre>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<ul>
<li>Implement mcsapply(), a multicore version of sapply(). Can you implement mcvapply(), a parallel version of vapply()?Why or why not?</li>
</ul>
</div>
<div id="solution-5" class="section level2">
<h2>Solution 5</h2>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="co"># We can use the function parSapply() to do this work.</span></a>
<a class="sourceLine" id="cb112-2" title="2"><span class="kw">library</span>(parallel) </a>
<a class="sourceLine" id="cb112-3" title="3">cores &lt;-<span class="st"> </span><span class="kw">detectCores</span>()</a>
<a class="sourceLine" id="cb112-4" title="4">cl &lt;-<span class="st"> </span><span class="kw">makePSOCKcluster</span>(cores<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb112-5" title="5"><span class="co">#parSapply(cl = NULL, X, FUN, ..., simplify = TRUE,          USE.NAMES = TRUE, chunk.size = NULL)</span></a>
<a class="sourceLine" id="cb112-6" title="6"><span class="kw">parSapply</span>(cl,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dt">FUN=</span>sin)</a></code></pre></div>
<pre><code>##  [1]  0.8414710  0.9092974  0.1411200 -0.7568025 -0.9589243 -0.2794155
##  [7]  0.6569866  0.9893582  0.4121185 -0.5440211</code></pre>
<hr />
</div>
<div id="homework-in-20191220" class="section level2">
<h2>Homework in 20191220</h2>
</div>
<div id="question-6" class="section level2">
<h2>Question</h2>
<ul>
<li>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task.</li>
<li>Compare the generated random numbers by the two functions using qqplot.</li>
<li>Campare the computation time of the two functions with microbenchmark.</li>
<li>Comments your results.</li>
</ul>
</div>
<div id="solution-6" class="section level2">
<h2>Solution</h2>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb114-2" title="2"><span class="kw">library</span>(microbenchmark)</a></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本3.6.2 来建造的</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb116-2" title="2"></a>
<a class="sourceLine" id="cb116-3" title="3"><span class="co"># Use Rcpp to solve the problem</span></a>
<a class="sourceLine" id="cb116-4" title="4"><span class="kw">cppFunction</span>(<span class="st">&#39;List Metropolis(double sigma, double x0 , int N){</span></a>
<a class="sourceLine" id="cb116-5" title="5"><span class="st">  NumericVector x(N);</span></a>
<a class="sourceLine" id="cb116-6" title="6"><span class="st">  NumericVector u=runif(N);</span></a>
<a class="sourceLine" id="cb116-7" title="7"><span class="st">    x[0]=x0;</span></a>
<a class="sourceLine" id="cb116-8" title="8"><span class="st">    int k=0;</span></a>
<a class="sourceLine" id="cb116-9" title="9"><span class="st">  for(int i = 1; i &lt; N; ++i) {</span></a>
<a class="sourceLine" id="cb116-10" title="10"><span class="st">        double y=rnorm(1,x[i-1],sigma)[0];</span></a>
<a class="sourceLine" id="cb116-11" title="11"><span class="st">      double p=exp(-abs(y))/exp(-abs(x[i-1]));</span></a>
<a class="sourceLine" id="cb116-12" title="12"><span class="st">        if(u[i-1]&lt;= p) {x[i]=y;}</span></a>
<a class="sourceLine" id="cb116-13" title="13"><span class="st">      else{x[i]=x[i-1]; k=k+1; } </span></a>
<a class="sourceLine" id="cb116-14" title="14"><span class="st">    }</span></a>
<a class="sourceLine" id="cb116-15" title="15"><span class="st">  List L=List::create(Named(&quot;x&quot;)=x,</span></a>
<a class="sourceLine" id="cb116-16" title="16"><span class="st">                      Named(&quot;k&quot;)=k);</span></a>
<a class="sourceLine" id="cb116-17" title="17"><span class="st">  return L;</span></a>
<a class="sourceLine" id="cb116-18" title="18"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb116-19" title="19"></a>
<a class="sourceLine" id="cb116-20" title="20">N =<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb116-21" title="21">sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb116-22" title="22">x0 =<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb116-23" title="23"></a>
<a class="sourceLine" id="cb116-24" title="24">cpp1=<span class="kw">Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</a>
<a class="sourceLine" id="cb116-25" title="25">cpp2=<span class="kw">Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</a>
<a class="sourceLine" id="cb116-26" title="26">cpp3=<span class="kw">Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</a>
<a class="sourceLine" id="cb116-27" title="27">cpp4=<span class="kw">Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</a>
<a class="sourceLine" id="cb116-28" title="28"></a>
<a class="sourceLine" id="cb116-29" title="29"><span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb116-30" title="30">Rej =<span class="st"> </span><span class="kw">cbind</span>(cpp1<span class="op">$</span>k, cpp2<span class="op">$</span>k, cpp3<span class="op">$</span>k, cpp4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb116-31" title="31">Acc =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Rej)<span class="op">/</span>N,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb116-32" title="32"><span class="kw">rownames</span>(Acc) =<span class="st"> &quot;Accept rates&quot;</span></a>
<a class="sourceLine" id="cb116-33" title="33"><span class="kw">colnames</span>(Acc) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</a>
<a class="sourceLine" id="cb116-34" title="34">knitr<span class="op">::</span><span class="kw">kable</span>(Acc)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">sigma 0.05</th>
<th align="right">sigma 0.5</th>
<th align="right">sigma 2</th>
<th align="right">sigma 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Accept rates</td>
<td align="right">0.985</td>
<td align="right">0.8615</td>
<td align="right">0.573</td>
<td align="right">0.114</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="co">#plot</span></a>
<a class="sourceLine" id="cb117-2" title="2"> <span class="co">#display 4 graphs together</span></a>
<a class="sourceLine" id="cb117-3" title="3">    rw =<span class="st"> </span><span class="kw">cbind</span>(cpp1<span class="op">$</span>x, cpp2<span class="op">$</span>x, cpp3<span class="op">$</span>x,  cpp4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb117-4" title="4">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb117-5" title="5">        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb117-6" title="6">             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb117-7" title="7">             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb117-8" title="8">    }</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAZlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb////tmb/25D//7b//9v///8ZM4qDAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAHvklEQVR4nO2da2PiKBSG6bTOXuruzHbq7tYdtfz/P7m5EAIJ8CYRCDHv86HVenKSPBJAPVIhSRCx9gGUDgUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUB5gi6HV+rnxchxJePVMdTHLMFnZ9/1rfekh1RYcwVpNQ0mnbBXEHXQyPo4rnIxGZIJQi0oM30+YkE1epfZNdd35luVZIIko2jp/dqIPP4oaCJ6cr3lFnQoO+b3gWuRiJB50pB20n7RrElWdcgjaBz1f/cjnUvTUEuPn+8Nj+rIZ6CXHQvME7PPynIRduCKk4vSFDxhhL1QUpLNRuiICfndgyr2lJYUPnX2MoTRQpC6SgIpKMgkI6CQDoKAukoCKSjIJCOgkA6CgLpKGiQZfhpSvEvxlZvQRQUTkdBIB0FgXQUhNJREEgnEiSPSQmCZpRQ5Gd9QULOKTLJTrLyF1CCJ4xbs8pwcpNOULgEj4ImF1CJ9iKbkT4ryQShErz+1k4FzWpBBQ/0iQTNKMETZc+EUg3z00vwdipoerr2VrGd0NpvmPVlDFHyx2f9FpQmfzQoCJBwFGuB86AF+XOSpgV5y4L86fYlqDL0MjPdzgRVM6DwF8XGggo1VEwnXWoToiAABQEoCHCHoH/u+Ubzowq6fe/uXw93feXbIajMcWyuoOPTe3PjdOdX4h9VUDUDrN8Iux4EmAjO3++DCKqngE/fhGpHMff7MIJUI4q+X1FmNz1f0LluQXevyeHa70MIuh3r5lP99L3ZDLKEFjR4BEEJR7EHEZRuHvQYgkwiz6QfT1D0/VIQSFfkRIiCACUJKvIaoyAABQEoCEBBAAoCUBCgKEElGkpU3TGjkHzpTjKRTtDUQnLrr+UZSiZo0UqcexLkLiQHS6TuSRBbUIDla7nuRJBcvJarmBCTl7LmQRSE0lEQSGcLKsHQHgUF8orRkRUsKEE1g1CJvTvelqD4nZBXkNiMIGGGDIOmNSl/lGqTQJD9aLGCRCdIdPfsR61c1hPvvzS9gvQD45dBpQpqjnMgSMQS5GianbnuG8buPYXII0gGBXkO23za7XUchv3JZEHeFH7yC5LqshJKgb7OOnW6XQlDp5KlI3W+9vy16EEzEV1i0SWce965BPXdgTRPXwmyDl8IO0IObLkE9Znslqa3E9JIN+e8Mwky+ssJgoQwT02Hm5E6rRSGINPBIMu6gqyn2xfR/pLGEyv0+enVYrozse5J49cUQdpzZ1uameedd94WpHvToSBDidW4JgkyNPgESeNZmHfeWQUJhyCrzQz8mIKM/tZoB1qQ1PkNQVI/IuVGBKmgvh82BqbRtTLof/VI1w93hixLkB4n1c6sA5l33tkESetchPmI0b6s604F6zOVqiV12+vQQa5eltysoMEmxjXTXxX6TPr4btJkNSj3YXge6f5anCBpzF9cgnTMQMlIkLAEefYopE9d0YL0mY6jhPFbWBEDB2YPvEjQhANdFnh/umFv4NrOr667a/bJ3j1uU1DoYb+gYWA/wPt1B3oneCSLA1dJ59/DBEFT0kzeXyyyCQo7gH7SCFpcH5SEsCC49eTdTA2Ud9QHJaFQQeX8p96ghPUETV5osnB20ILuI5Ggeujg/3oO4akPMt/D2QarzYM2Q0JB+r+J3p10YtwqYQvDaygIQEEACgJQ0N1QUKSkFBQnjoJKDFsYvj8oCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQIL6giwgtS91/+KjjwhuEuP7yETvliOiCLvUHi/6ju359H8SBDQLcjk2FQMyUY2ILat+wPnmX7u6qHnQc2sDPRdUpRUzpILagtvrj7K2wOr8M4tAGXi7itVUTL6WL6IKa9u6rjqme11+r/uLViEMbhGi3ippyRGxB7aXv7QBux7pu5vTax4ENwjurHcRNOSKzIBX05SOeoLgpR+S+xNqgw1vESyxqyhG5O+k26Ot7lB7VFBQp5YjMw3x77NWJRRmTG0FxU47IPVFsDrvqUaPM6tQoFjPliPgvNc4iOM0/VWPymxUHNgigLrGYKUfwxSqAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBNiKILOwt6/7zcBGBFn1GrruNwfbEGRX/ESqHZvGNgTZNWPnTFdXQ1GCPv8+NKtDjRZPsasOu7rfLBQl6PT8r7x+d6yvZ9Wt6rrfLJQkSLWT35s7J7XWWHM5OQp7c3VEJQlqz/n2x3iMchT2qhUvk1OgIMc6sY7C3lxjfUmCWjWqaViXmDXM67rfLAdVkqCqk/mrcuFaBdWaKOq63xwUJUj+96cQvzlXiVWFvZ8/Gjld3W8GyhJUIBQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEOB/YSOTyenuwtEAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1"><span class="co"># Use R to solve the problem</span></a>
<a class="sourceLine" id="cb118-2" title="2">lap_f =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</a>
<a class="sourceLine" id="cb118-3" title="3">rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N){</a>
<a class="sourceLine" id="cb118-4" title="4"> x =<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb118-5" title="5"> x[<span class="dv">1</span>] =<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb118-6" title="6"> u =<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb118-7" title="7"> k =<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb118-8" title="8"> <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb118-9" title="9">  y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb118-10" title="10">  <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">lap_f</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">lap_f</span>(x[i<span class="dv">-1</span>]))) x[i] =<span class="st"> </span>y </a>
<a class="sourceLine" id="cb118-11" title="11">  <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb118-12" title="12">  x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb118-13" title="13">  k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb118-14" title="14">  }</a>
<a class="sourceLine" id="cb118-15" title="15"> }</a>
<a class="sourceLine" id="cb118-16" title="16"> <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k))</a>
<a class="sourceLine" id="cb118-17" title="17">}</a>
<a class="sourceLine" id="cb118-18" title="18"></a>
<a class="sourceLine" id="cb118-19" title="19">rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N)</a>
<a class="sourceLine" id="cb118-20" title="20">rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N)</a>
<a class="sourceLine" id="cb118-21" title="21">rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N)</a>
<a class="sourceLine" id="cb118-22" title="22">rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N)</a>
<a class="sourceLine" id="cb118-23" title="23"></a>
<a class="sourceLine" id="cb118-24" title="24"><span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb118-25" title="25">Rej =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)</a>
<a class="sourceLine" id="cb118-26" title="26">Acc =<span class="st"> </span><span class="kw">round</span>((N<span class="op">-</span>Rej)<span class="op">/</span>N,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb118-27" title="27"><span class="kw">rownames</span>(Acc) =<span class="st"> &quot;Accept rates&quot;</span></a>
<a class="sourceLine" id="cb118-28" title="28"><span class="kw">colnames</span>(Acc) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;sigma&quot;</span>,sigma)</a>
<a class="sourceLine" id="cb118-29" title="29">knitr<span class="op">::</span><span class="kw">kable</span>(Acc)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">sigma 0.05</th>
<th align="right">sigma 0.5</th>
<th align="right">sigma 2</th>
<th align="right">sigma 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Accept rates</td>
<td align="right">0.982</td>
<td align="right">0.827</td>
<td align="right">0.543</td>
<td align="right">0.113</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="co">#plot</span></a>
<a class="sourceLine" id="cb119-2" title="2">  <span class="co">#display 4 graphs together</span></a>
<a class="sourceLine" id="cb119-3" title="3">    rw =<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb119-4" title="4">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb119-5" title="5">        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb119-6" title="6">             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb119-7" title="7">             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb119-8" title="8">    }</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAb1BMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6OpA6ZpA6ZrY6kNtmAABmADpmOgBmZjpmZrZmtttmtv+QOgCQ2/+2ZgC2Zjq2Zma22/+2///bkDrbtpDb2//b////tmb/25D//7b//9v///8w2qIwAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJAElEQVR4nO2dC3ubNhSG1a5Jd0u2dU29rd5iJ/r/v3EYIRDW5ZPgCDD+3j1PZsfiSLwF3ZAVpUkStXYBtg4FASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgIIC1I3w1qCZMPVg4IAFATYlqANaqMgwMYEqe6D7ZjalKChWZ2fm1R5KUgqDgUtlGEqnBGkRHLbpyBtBCkJQUIF3pqg/r+5Ge5IkHJeddeQultBoUGyGr3qP79PQaFw1QSJ1PY7FqR2JEgNvyyfqYpkQEEgg07Q7DjiCUvDqStBWk6Q2oeg1kn/S2X707NPrOsw3LogdSXItj8zT6zvke9Y0KwclViPXDxhWTjlCBq19xTU/d9WFNenMnPIqvTOBHmjLytoYr67EmQNqesk8wTpfQjSSNCkjNWOBOmUoKnNtLJx5/cXxBOWhUsLsnND5eH3J8hvtPpBx4S8bcfq5gWphCBn5qM4870J0khQYWWrrgTN61AJJywJN1QwKUGBXhKKfjWlezuCrmZ7oCC3IioowSjtTQm6Djf6h/YE6SJBKvhyR4K8HPp6Km8GLSpo1riXgvKjCiUsCqf8XwXS2lnGdClSgtKlz4yapkTQ2/NT8/PUlOvj93S4LEG6F5Q8USfkOBk0tI6g46fXy6uvyXCigoyaWxHUqWk1xcPlC8K94i7BrQg6P7aCTpGbLBAOnny2IFUmKOfGxdS5gnJz6C6L5PqzrrMUEAQaMqe3WlaqaQn1RdClRA/aVtczw9lDhqcfwaOjglBLv7wg3Tr68K1pyCJ+5goKXYCOoOBn8bhrCKoQLi3Izm0HZSTnlBxBhTf+tITVwo3HuH5FbH8/QVDfZ59R0ImCjvmtGCzBdEGBkbB7qF5RkGQ4V9C1BQrSgyCl/YqmG6olBEVzHGp1YUF/x8ZZ08JlHDOMWB1X/UfdJ5GrJSpIuYJCanNL1/58+2Lfnx+jA1E9pImMxGYL0mNByrlNot3IREkEBT03vZsLh/hA3XYUDeNkw+9z8x0VISVoSBQ+OEdQ4NjSW+z95dJDPj+2/eQoXQdR+grSehCkCwVFcxwL8nsIBaUznNSHP1R3HUV5e76MwYQF2eNGgrrLCcfDgoIT3xMqaXMRIQ6NwwUEKed+w0emIooJOl6uIFxBN+meKgvqhxUzBLnzRyoUqVRQU/8+tD9jo9CB8+MPNQTZU3LGXXME2f6TtqO5qQUtacU6mnuxmiA9tIiSggIzJfklu1DWD4LhJhynaghy5nPn3mIOqZ70scnYzCjKDVbNce7YW6nI/E9+jjUFJTg2N+Lb86WtkxY0mr2xZyQhyF+LnDosO36Y95en9mfTF9q4ILWOIPs07PDptaYgLSwomKziFdRweJAXpK8F5Q7sQqkcQSqcqlId1Glp+kv1BDkd4MwjA79bSVDTipmb7P1FWlDgFG5RUM1wcoLsYyIKimTpzpJQUFqQ3pEgL5SooOtkCwuaNeUajZmZLlQYP8q6gqqEExGkKcifyaCgcTK//qWgUbJ0A3U1gulnnYRLsVK4SXmGy0BBoAzdclF7wd2VoKzqhYJAGe5YUF4DZRdlU1BaUKTVzw4+FwpaNtyUTCNFUOqOBY1ypSA/0zxB+r4F9TlTkJ9pjiA9XgZ6h4LQtXHHgvT2BdWYci3JXmcI0uO56pLYgqwpSHUv4skoiILiuQ7r0tLp/Jc4tiAUtGy4glyHL+Gn0/kvcex83l/MvxPaeWFhhsXDKws62mXU0W/1rilIw55GbUH9CrOi780vwCAo/cC6tiBnx46CnRcWQNl14ysL2u4VlCnIPSQ7dklB7Aq8rdVBzjcP1hXUf+cwcv1Q0NLhsrNVNncKCme7OUHiC8nn4QjKPSI79JTyLBYuO1s44eodkR26uDBLhqsHBQFqCjqp+NfH713QQamn88+v3jaBK89JT6COoEPTQTy0V090qHEz1BDUXjfnzxdBscFqWVDZPot0D6g8udn77v0/Hb+CyoLuTdDQPYxuE1gWdHeC2q8960s7Ft1ZoCjo/gQJB6UgmXQ3JAjuvFAWdHeC8M4LZUH3Jihj54WyoHsTlLHzwv6Y9FQjvvPC/pjUUYzvvLA/SlsxsPPC/riZ+Ym1oCAABQEoCEBBAAoCUBCAggAUBJAXdEo8V3T//E2fLn1AivOP36VDeogLOl3+tE28dOapkZsOHJDg7bkd8EiG9JEWZEb8h+jW3faBWp8OHRDn1K3XFgwZQFqQ2Yw7PhtyfLhKhw6IclJPRo1cyBDigsCD18NPTX3x5KTLeVIbwxwlGtJDWpC59aMVgPmrAYenIR04IJ3ZxYFsSI+FBXWJPn6XEyQb0mPpW8wkevwqeIuJhvRYupI2iT5/E6lRXUFCIT0WbuZN2ZsTE2mTW0GyIT2W7ii2xW5qVJFeXdeKSYb0kB9qHNPd/EP/9NqmAwck6G4xyZAeHKwCKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQYAbEDRa02vfDGt/K7N9QaOlGv2bfu1vbTYvaLTYZ3gjtH4Ms3lBo+Viw5vjAndXy1YEvf/12G4M5W27M1pwOLyxa3+rsxVBh0//6POXwK5NoyWr/Zt+7W91NiKouzR+Ne8O3T5j7RdUgoJMuiUqoo0IMqf69pvfNEVuMfPZY3qjJwm2JejZP+FIJW0+W6Ct34ggo8ZeEe4tFm7m+7W/1Uu2EUFNvfKn2Xgn8Emoo9iv/a3NVgTpf39X6pfg3oPdmt73lwftLPDt1/5WZjOCtgoFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAT4Hwy3DC4cuimDAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1"><span class="co">## Compare the generated random numbers by the two functions using qqplot.</span></a>
<a class="sourceLine" id="cb120-2" title="2"><span class="co">## Acturally, I don&#39;t know what this problem means.I compared x in two methods,but it is doesn&#39;t make sense.</span></a>
<a class="sourceLine" id="cb120-3" title="3">    </a>
<a class="sourceLine" id="cb120-4" title="4"></a>
<a class="sourceLine" id="cb120-5" title="5"><span class="kw">qqplot</span>(cpp1<span class="op">$</span>x,rw1<span class="op">$</span>x)    </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">qqplot</span>(cpp2<span class="op">$</span>x,rw2<span class="op">$</span>x)   </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" title="1"><span class="kw">qqplot</span>(cpp3<span class="op">$</span>x,rw3<span class="op">$</span>x)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">qqplot</span>(cpp4<span class="op">$</span>x,rw4<span class="op">$</span>x)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="co">## Campare the computation time of the two functions with microbenchmark.</span></a>
<a class="sourceLine" id="cb124-2" title="2">ts1=<span class="kw">microbenchmark</span>(<span class="dt">rpp=</span><span class="kw">Metropolis</span>(sigma[<span class="dv">1</span>],x0,N),<span class="dt">r=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>],x0,N))</a>
<a class="sourceLine" id="cb124-3" title="3"><span class="kw">summary</span>(ts1)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1  rpp  310.65  319.10  326.40
## 2    r 4731.05 4857.85 4951.45</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1">ts2=<span class="kw">microbenchmark</span>(<span class="dt">rpp=</span><span class="kw">Metropolis</span>(sigma[<span class="dv">2</span>],x0,N),<span class="dt">r=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>],x0,N))</a>
<a class="sourceLine" id="cb126-2" title="2"><span class="kw">summary</span>(ts2)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr     lq  median      uq
## 1  rpp  243.9  253.60  260.80
## 2    r 4769.8 4920.45 5032.95</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">ts3=<span class="kw">microbenchmark</span>(<span class="dt">rpp=</span><span class="kw">Metropolis</span>(sigma[<span class="dv">3</span>],x0,N),<span class="dt">r=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>],x0,N))</a>
<a class="sourceLine" id="cb128-2" title="2"><span class="kw">summary</span>(ts3)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr      lq  median      uq
## 1  rpp  268.00  275.90  280.50
## 2    r 4860.25 4962.85 5065.75</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1">ts4=<span class="kw">microbenchmark</span>(<span class="dt">rpp=</span><span class="kw">Metropolis</span>(sigma[<span class="dv">4</span>],x0,N),<span class="dt">r=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>],x0,N))</a>
<a class="sourceLine" id="cb130-2" title="2"><span class="kw">summary</span>(ts4)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr      lq median      uq
## 1  rpp  276.85  284.9  292.75
## 2    r 4944.55 5014.4 5121.60</code></pre>
<ul>
<li>From the compared time we can find that cpp methods is much better than R methods.It is significante that Rcpp can improve the computational efficency.</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
